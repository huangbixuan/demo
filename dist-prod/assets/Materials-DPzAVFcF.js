import{_ as he,r as o,aj as ye,a4 as _e,c as v,i as x,o as r,h as l,F as U,G as J,g as p,N as xe,a as V,aK as K,w as t,ap as ke,ak as we,O as D,M as ze,l as g,J as N,v as be,y as Ce,t as H,P as Ve,al as Pe,am as Be,an as Te,m as Se,E as Ne,a5 as Ee,ao as Ge,cm as je,q as Ae,s as Ie,aq as P}from"./index-QQaZ7rbf.js";import{E as Ue}from"./el-image-DHi7RmhO.js";import{b as Je,d as Me,p as Fe,c as Oe,e as $e,g as qe,a as Ke}from"./material-mdbw-jQF.js";import{E as De}from"./index-D_95hI5s.js";import{E as He}from"./index-BctfKmg_.js";const Le={key:0},Qe=["src"],Re={class:"el-upload-list__item-actions"},We=["onClick"],Xe=["onClick"],Ye=(d=>(Ae("data-v-96a36299"),d=d(),Ie(),d))(()=>p("i",{class:"el-icon-view"},null,-1)),Ze=["onClick"],ea=["onClick"],aa={style:{"margin-bottom":"10px"}},la={key:0},ta={class:"dialog-footer"},ua=he({__name:"Materials",props:{modelValue:{type:Array,default:()=>[]},type:{type:String},num:{type:Number,default:()=>5},width:{type:Number,default:()=>150},height:{type:Number,default:()=>150}},emits:["update:modelValue"],setup(d,{emit:L}){const y=d,Q=o({Authorization:"Bearer "+ye()}),R=o(!1),W=o(""),k=o(!1),X=o(!1),w=o([]),E=o(""),m=o({}),G=o(!1),B=o([]),M=o(0),s=o({total:0,currentPage:1,pageSize:12,ascs:[],descs:"create_time"}),T=o(!1),z=o(null),_=o([]),i=_e({get:()=>y.modelValue&&y.modelValue.length!=0?Array.isArray(y.modelValue)?y.modelValue:[y.modelValue]:[]});function F(e,a){if(a=="up"){const c=i.value[e-1];i.value[e-1]=i.value[e],i.value[e]=c}if(a=="down"){const c=i.value[e+1];i.value[e+1]=i.value[e],i.value[e]=c}}function Y(){k.value=!0,X.value=!0,B.value.length<=0&&j()}function j(){G.value=!0,qe({total:0,pageNo:1,pageSize:100,ascs:[],sort:"create_time,desc"}).then(e=>{G.value=!1,w.value=e,w.value.unshift({id:"-1",name:"\u5168\u90E8\u5206\u7EC4"}),O({index:0})})}function O(e){_.value=[];const a=Number(e.index);m.value=w.value[a],m.value.index=a,E.value=m.value.id,s.value.currentPage=1,s.value.total=0,m.value.id!="-1"?z.value=m.value.id:z.value=null,b(s.value)}function b(e){T.value=!0,Ke(Object.assign({pageNo:e.currentPage,pageSize:e.pageSize,descs:e.descs,ascs:e.ascs,sort:"create_time,desc"},{groupId:z.value})).then(a=>{s.value.total=a.total,s.value.currentPage=e.currentPage,s.value.pageSize=e.pageSize,B.value=a.list,T.value=!1}).catch(a=>{T.value=!1})}function Z(e){s.value.currentPage=1,s.value.pageSize=e,b(this.page)}function ee(e){s.value.currentPage=e,b(s.value)}function ae(e){}function le(e,a,c){$e({type:"1",groupId:z.value!="-1"?z.value:null,name:a.name,url:e.data}).then(()=>{M.value++,c.length===M.value&&b(s.value)})}function te(e){const a=e.type==="image/jpeg"||e.type==="image/png"||e.type==="image/gif"||e.type==="image/jpg",c=e.size/1024/1024<2;return a?(c||this.$message.error("\u4E0A\u4F20\u5934\u50CF\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 2MB!"),a&&c):(this.$message.error("\u4E0A\u4F20\u56FE\u7247\u53EA\u80FD\u662F JPG\u3001JPEG\u3001PNG\u3001GIF \u683C\u5F0F!"),!1)}const A=L;function ue(){_.value.forEach(e=>{i.value[i.value.length]=e}),k.value=!1,_.value.length>1||y.num>1?A("update:modelValue",i.value):A("update:modelValue",i.value[0])}return(e,a)=>{const c=xe,f=ze,ne=Ce,ie=be,se=we,S=Ne,oe=Ge,I=Se,ce=Be,re=Ue,de=Ee,$=De,pe=Te,ve=He,me=Pe,ge=ke,fe=je,q=Ve;return d.type=="image"?(r(),v("div",Le,[(r(!0),v(U,null,J(V(i),(u,n)=>(r(),v("ul",{key:n,class:"el-upload-list el-upload-list--picture-card"},[p("li",{tabindex:"0",class:"el-upload-list__item is-ready",style:K("width: "+d.width+"px;height: "+d.height+"px")},[p("div",null,[p("img",{src:u,alt:"",class:"el-upload-list__item-thumbnail"},null,8,Qe),p("span",Re,[n!=0?(r(),v("span",{key:0,class:"el-upload-list__item-preview",onClick:h=>F(n,"up")},[l(c,{icon:"ep:back"})],8,We)):x("",!0),p("span",{class:"el-upload-list__item-preview",onClick:h=>function(C){R.value=!0,W.value=i.value[C]}(n)},[Ye,l(c,{icon:"ep:view"})],8,Xe),p("span",{class:"el-upload-list__item-delete",onClick:h=>function(C){P.confirm("\u662F\u5426\u786E\u8BA4\u5220\u9664\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(function(){i.value.splice(C,1),_.value=[],A("update:modelValue",i.value)})}(n)},[l(c,{icon:"ep:delete"})],8,Ze),n!=V(i).length-1?(r(),v("span",{key:1,class:"el-upload-list__item-preview",onClick:h=>F(n,"down")},[l(c,{icon:"ep:right"})],8,ea)):x("",!0)])])],4)]))),128)),d.num>V(i).length?(r(),v("div",{key:0,tabindex:"0",class:"el-upload el-upload--picture-card",style:K("width: "+d.width+"px;height: "+d.height+"px;line-height:"+d.height+"px;"),onClick:Y},[l(c,{icon:"ep:plus"})],4)):x("",!0),l(fe,{title:"\u56FE\u7247\u7D20\u6750\u5E93","append-to-body":"",modelValue:k.value,"onUpdate:modelValue":a[7]||(a[7]=u=>k.value=u),width:"70%"},{footer:t(()=>[p("span",ta,[l(f,{onClick:a[6]||(a[6]=u=>k.value=!1)},{default:t(()=>[g("\u53D6 \u6D88")]),_:1}),l(f,{type:"primary",onClick:ue},{default:t(()=>[g("\u786E \u5B9A")]),_:1})])]),default:t(()=>[l(ge,null,{default:t(()=>[l(se,{width:"100px"},{default:t(()=>[p("div",aa,[l(f,{class:"el-icon-plus",size:"small",onClick:a[0]||(a[0]=u=>{P.prompt("\u8BF7\u8F93\u5165\u5206\u7EC4\u540D","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88"}).then(({value:n})=>{Je({name:n}).then(function(){j()})}).catch(()=>{})})},{default:t(()=>[g(" \u6DFB\u52A0\u5206\u7EC4 ")]),_:1})]),D((r(),N(ie,{modelValue:E.value,"onUpdate:modelValue":a[1]||(a[1]=u=>E.value=u),"tab-position":"left",onTabClick:O},{default:t(()=>[(r(!0),v(U,null,J(w.value,u=>(r(),N(ne,{key:u.id,name:u.id},{label:t(()=>[p("span",null,H(u.name),1)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])),[[q,G.value]])]),_:1}),l(me,null,{default:t(()=>[l($,null,{header:t(()=>[p("div",null,[l(I,null,{default:t(()=>[l(S,{span:12},{default:t(()=>[p("span",null,H(m.value.name),1),m.value.id!="-1"?(r(),v("span",la,[l(f,{size:"small",type:"text",class:"el-icon-edit",style:{"margin-left":"10px"},onClick:a[2]||(a[2]=u=>{return n=m.value,void P.prompt("\u8BF7\u8F93\u5165\u5206\u7EC4\u540D","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",inputValue:n.name}).then(({value:h})=>{Fe({id:n.id,name:h}).then(function(){n.name=h,w.value[n.index]=n})}).catch(()=>{});var n})},{default:t(()=>[g("\u91CD\u547D\u540D")]),_:1}),l(f,{size:"small",type:"text",class:"el-icon-delete",style:{"margin-left":"10px",color:"red"},onClick:a[3]||(a[3]=u=>{return n=m.value,void P.confirm("\u662F\u5426\u786E\u8BA4\u5220\u9664\u8BE5\u5206\u7EC4\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(function(){Oe(n.id).then(function(){j()})});var n})},{default:t(()=>[g("\u5220\u9664")]),_:1})])):x("",!0)]),_:1}),l(S,{span:12,style:{"text-align":"right"}},{default:t(()=>[l(oe,{action:V("https://meeting.ai-centre.org/admin-api/infra/file/upload"),headers:Q.value,"file-list":[],"on-progress":ae,"before-upload":te,"on-success":le,data:{type:1},multiple:""},{default:t(()=>[l(f,{size:"small",type:"primary"},{default:t(()=>[g("\u6279\u91CF\u4E0A\u4F20")]),_:1})]),_:1},8,["action","headers"])]),_:1})]),_:1})])]),default:t(()=>[D((r(),v("div",null,[B.value.length<=0?(r(),N(ce,{key:0,title:"\u6682\u65E0\u6570\u636E",type:"info",closable:!1,center:"","show-icon":""})):x("",!0),l(pe,{modelValue:_.value,"onUpdate:modelValue":a[4]||(a[4]=u=>_.value=u),max:d.num-V(i).length},{default:t(()=>[l(I,{gutter:5},{default:t(()=>[(r(!0),v(U,null,J(B.value,(u,n)=>(r(),N(S,{key:n,span:4},{default:t(()=>[l($,{"body-style":{padding:"5px"}},{default:t(()=>[l(re,{style:{width:"100%",height:"100px"},src:u.url,fit:"contain","preview-src-list":[u.url],"z-index":9999},null,8,["src","preview-src-list"]),p("div",null,[l(de,{class:"material-name",label:u.url},{default:t(()=>[g(" \u9009\u62E9 ")]),_:2},1032,["label"]),l(I,null,{default:t(()=>[l(S,{span:24,class:"col-do"},{default:t(()=>[l(f,{type:"text",size:"medium",onClick:h=>function(C){P.confirm("\u662F\u5426\u786E\u8BA4\u5220\u9664\u8BE5\u7D20\u6750\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(function(){Me(C.id).finally(function(){b(s.value)})})}(u)},{default:t(()=>[g("\u5220\u9664")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue","max"]),l(ve,{"current-page":s.value.currentPage,"onUpdate:currentPage":a[5]||(a[5]=u=>s.value.currentPage=u),"page-sizes":[12,24],"page-size":s.value.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:s.value.total,class:"pagination",onSizeChange:Z,onCurrentChange:ee},null,8,["current-page","page-size","total"])])),[[q,T.value]])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])):x("",!0)}}},[["__scopeId","data-v-96a36299"]]);export{ua as _};
