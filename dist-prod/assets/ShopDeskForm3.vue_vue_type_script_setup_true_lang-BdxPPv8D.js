import{d as D,e as E,z as T,r,A as U,J as m,o as v,w as d,O as j,B,a as l,h as t,C as G,D as H,c as K,F as J,G as M,K as P,l as f,P as R,M as L,x as W}from"./index-QQaZ7rbf.js";import{_ as X}from"./Dialog.vue_vue_type_style_index_0_lang-BZRnyNPI.js";import{E as Y}from"./el-text-CnZwsJZ9.js";import{E as Z}from"./el-image-DHi7RmhO.js";import{g as $,a as g,d as ee}from"./index-BiAqHivH.js";import{d as ae}from"./download--D_IyRio.js";const le=D({__name:"ShopDeskForm3",setup(oe,{expose:_}){const{t:w}=E(),Q=T(),s=r(!1),c=r(""),u=r(!1),I=r(""),e=r({id:void 0,shopId:void 0,shopName:void 0,number:void 0,miniQrcode:void 0,h5Qrcode:void 0,aliQrcode:void 0,note:void 0,orderCount:void 0,costAmount:void 0,lastOrderNo:void 0,lastOrderTime:void 0,lastOrderStatus:void 0,status:void 0,env:"trial"}),O=U({shopId:[{required:!0,message:"\u95E8\u5E97\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],number:[{required:!0,message:"\u684C\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],status:[{required:!0,message:"\u72B6\u6001\uFF1A1=\u542F\u7528\uFF0C2=\u7981\u7528\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),h=r(),k=r([{id:1,name:"\u6B63\u5F0F\u7248",value:"release"},{id:2,name:"\u4F53\u9A8C\u7248",value:"trial"},{id:3,name:"\u5F00\u53D1\u7248",value:"develop"}]),n=r({});_({open:async(a,o)=>{if(s.value=!0,c.value=w("action."+a),I.value=a,V(),o){u.value=!0;try{e.value=await $(o),e.value.env="trial",n.value=await g({id:o,number:e.value.number,shopId:e.value.shopId,env:e.value.env})}finally{u.value=!1}}}});const x=async a=>{n.value=await g({id:e.value.id,number:e.value.number,shopId:e.value.shopId,env:a})},C=async()=>{await Q.confirm("\u5C0F\u7A0B\u5E8F\u4E8C\u7EF4\u7801\u53EA\u80FD\u4E0B\u8F7D\u6B63\u5F0F\u7684\u54E6"),u.value=!0;try{const a=await ee(e.value.id);ae.zip(a,e.value.shopName+e.value.number+".zip"),s.value=!1}finally{u.value=!1}},V=()=>{var a;e.value={id:void 0,shopId:void 0,shopName:void 0,number:void 0,miniQrcode:void 0,h5Qrcode:void 0,aliQrcode:void 0,note:void 0,orderCount:void 0,costAmount:void 0,lastOrderNo:void 0,lastOrderTime:void 0,lastOrderStatus:void 0,status:1,env:"trial"},(a=h.value)==null||a.resetFields()};return(a,o)=>{const N=P,q=H,p=G,b=Z,z=Y,A=B,y=L,F=X,S=R;return v(),m(F,{title:l(c),modelValue:l(s),"onUpdate:modelValue":o[2]||(o[2]=i=>W(s)?s.value=i:null)},{footer:d(()=>[t(y,{onClick:C,type:"primary",disabled:l(u)},{default:d(()=>[f("\u4E0B \u8F7D")]),_:1},8,["disabled"]),t(y,{onClick:o[1]||(o[1]=i=>s.value=!1)},{default:d(()=>[f("\u53D6 \u6D88")]),_:1})]),default:d(()=>[j((v(),m(A,{ref_key:"formRef",ref:h,model:l(e),rules:l(O),"label-width":"120px"},{default:d(()=>[t(p,{label:"\u5C0F\u7A0B\u5E8F\u7248\u672C",prop:"env"},{default:d(()=>[t(q,{modelValue:l(e).env,"onUpdate:modelValue":o[0]||(o[0]=i=>l(e).env=i),onChange:x},{default:d(()=>[(v(!0),K(J,null,M(l(k),i=>(v(),m(N,{key:i.id,label:i.name,value:i.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"\u5C0F\u7A0B\u5E8F\u4E8C\u7EF4\u7801"},{default:d(()=>[l(n).miniQrcode!=""?(v(),m(b,{key:0,style:{width:"200px",height:"200px"},src:l(n).miniQrcode,fit:a.fit},null,8,["src","fit"])):(v(),m(z,{key:1,type:"danger"},{default:d(()=>[f("\u5C0F\u7A0B\u5E8F\u672A\u914D\u7F6E")]),_:1}))]),_:1}),t(p,{label:"H5\u4E8C\u7EF4\u7801"},{default:d(()=>[t(b,{style:{width:"200px",height:"200px"},src:l(n).normalQrcode,fit:a.fit},null,8,["src","fit"])]),_:1})]),_:1},8,["model","rules"])),[[S,l(u)]])]),_:1},8,["title","modelValue"])}}});export{le as _};
