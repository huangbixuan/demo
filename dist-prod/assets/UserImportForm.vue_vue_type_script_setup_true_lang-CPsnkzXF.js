import{_ as S}from"./Dialog.vue_vue_type_style_index_0_lang-BZRnyNPI.js";import{d as q,z as A,r as i,J as B,o as J,w as r,h as d,ao as M,a as o,x as _,g as f,N,l as v,a5 as O,a6 as D,M as K,dq as R,aj as E,aL as G}from"./index-QQaZ7rbf.js";import{i as H}from"./index-uPKJ4_LV.js";import{d as P}from"./download--D_IyRio.js";const Q=f("div",{class:"el-upload__text"},[v("\u5C06\u6587\u4EF6\u62D6\u5230\u6B64\u5904\uFF0C\u6216"),f("em",null,"\u70B9\u51FB\u4E0A\u4F20")],-1),T={class:"el-upload__tip text-center"},W={class:"el-upload__tip"},X=f("span",null,"\u4EC5\u5141\u8BB8\u5BFC\u5165 xls\u3001xlsx \u683C\u5F0F\u6587\u4EF6\u3002",-1),Y=q({name:"SystemUserImportForm",__name:"UserImportForm",emits:["success"],setup(Z,{expose:g,emit:h}){const m=A(),n=i(!1),t=i(!1),x=i(),y=i(),c=i([]),p=i(0);g({open:()=>{n.value=!0,p.value=0,c.value=[],C()}});const b=async()=>{c.value.length!=0?(y.value={Authorization:"Bearer "+E(),"tenant-id":R()},t.value=!0,x.value.submit()):m.error("\u8BF7\u4E0A\u4F20\u6587\u4EF6")},V=h,k=a=>{if(a.code!==0)return m.error(a.msg),void(t.value=!1);const e=a.data;let s="\u4E0A\u4F20\u6210\u529F\u6570\u91CF\uFF1A"+e.createUsernames.length+";";for(let l of e.createUsernames)s+="< "+l+" >";s+="\u66F4\u65B0\u6210\u529F\u6570\u91CF\uFF1A"+e.updateUsernames.length+";";for(const l of e.updateUsernames)s+="< "+l+" >";s+="\u66F4\u65B0\u5931\u8D25\u6570\u91CF\uFF1A"+Object.keys(e.failureUsernames).length+";";for(const l in e.failureUsernames)s+="< "+l+": "+e.failureUsernames[l]+" >";m.alert(s),t.value=!1,n.value=!1,V("success")},w=()=>{m.error("\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u60A8\u91CD\u65B0\u4E0A\u4F20\uFF01"),t.value=!1},C=async()=>{var a;t.value=!1,await G(),(a=x.value)==null||a.clearFiles()},F=()=>{m.error("\u6700\u591A\u53EA\u80FD\u4E0A\u4F20\u4E00\u4E2A\u6587\u4EF6\uFF01")},j=async()=>{const a=await H();P.excel(a,"\u7528\u6237\u5BFC\u5165\u6A21\u7248.xls")};return(a,e)=>{const s=N,l=O,z=D,I=M,U=K,L=S;return J(),B(L,{modelValue:o(n),"onUpdate:modelValue":e[3]||(e[3]=u=>_(n)?n.value=u:null),title:"\u7528\u6237\u5BFC\u5165",width:"400"},{footer:r(()=>[d(U,{disabled:o(t),type:"primary",onClick:b},{default:r(()=>[v("\u786E \u5B9A")]),_:1},8,["disabled"]),d(U,{onClick:e[2]||(e[2]=u=>n.value=!1)},{default:r(()=>[v("\u53D6 \u6D88")]),_:1})]),default:r(()=>[d(I,{ref_key:"uploadRef",ref:x,"file-list":o(c),"onUpdate:fileList":e[1]||(e[1]=u=>_(c)?c.value=u:null),action:"https://meeting.ai-centre.org/admin-api/system/user/import?updateSupport="+o(p),"auto-upload":!1,disabled:o(t),headers:o(y),limit:1,"on-error":w,"on-exceed":F,"on-success":k,accept:".xlsx, .xls",drag:""},{tip:r(()=>[f("div",T,[f("div",W,[d(l,{modelValue:o(p),"onUpdate:modelValue":e[0]||(e[0]=u=>_(p)?p.value=u:null)},null,8,["modelValue"]),v(" \u662F\u5426\u66F4\u65B0\u5DF2\u7ECF\u5B58\u5728\u7684\u7528\u6237\u6570\u636E ")]),X,d(z,{underline:!1,style:{"font-size":"12px","vertical-align":"baseline"},type:"primary",onClick:j},{default:r(()=>[v(" \u4E0B\u8F7D\u6A21\u677F ")]),_:1})])]),default:r(()=>[d(s,{icon:"ep:upload"}),Q]),_:1},8,["file-list","action","disabled","headers"])]),_:1},8,["modelValue"])}}});export{Y as _};
