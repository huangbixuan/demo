import{_ as ie,r as o,aj as se,f as oe,c as T,o as p,g as x,h as l,w as t,ak as re,O as G,M as ce,l as _,J as S,v as de,F as M,G as $,y as pe,t as F,P as me,al as fe,i as J,am as ve,an as ge,m as he,E as ye,a5 as xe,ao as _e,a as we,ap as be,aq as I}from"./index-QQaZ7rbf.js";import{E as ze}from"./el-image-DHi7RmhO.js";import{g as Pe,a as ke,b as Ee,d as Ce,p as Te,c as Be,e as Ne}from"./material-mdbw-jQF.js";import{E as Se}from"./index-D_95hI5s.js";import{E as Ie}from"./index-BctfKmg_.js";(function(){if(window.frameElement.id){let B=window.parent,k=B.$EDITORUI[window.frameElement.id.replace(/_iframe$/,"")],m=k.editor,b=B.UE,f=b.dom.domUtils,y=b.utils;b.browser,b.ajax;let r=function(v){return document.getElementById(v)};window.nowEditor={editor:m,dialog:k},y.loadFile(document,{href:m.options.themePath+m.options.theme+"/dialogbase.css?cache="+Math.random(),tag:"link",type:"text/css",rel:"stylesheet"});var w=m.getLang(k.className.split("-")[2]);w&&f.on(window,"load",function(){var v=m.options.langPath+m.options.lang+"/images/";for(var z in w.static){var d=r(z);if(!d)continue;let E=d.tagName,u=w.static[z];switch(u.src&&(u=y.extend({},u,!1),u.src=v+u.src),u.style&&(u=y.extend({},u,!1),u.style=u.style.replace(/url\s*\(/g,"url("+v)),E.toLowerCase()){case"var":d.parentNode.replaceChild(document.createTextNode(u),d);break;case"select":for(var n,P=d.options,g=0;n=P[g];)n.innerHTML=u.options[g++];for(var h in u)h!="options"&&d.setAttribute(h,u[h]);break;default:f.setAttributes(d,u)}}})}})();const Ve={style:{"margin-bottom":"10px"}},je={key:0},Ue={class:"dialog-footer",style:{color:"red"}},Ae=ie({__name:"editorMaterials",props:{value:{type:Array,default:()=>[]},type:{type:String},num:{type:Number,default:()=>5},width:{type:Number,default:()=>150},height:{type:Number,default:()=>150}},setup(w){const B=w,k=o({Authorization:"Bearer "+se()}),m=o(B.value),b=o(!1),f=o([]),y=o(""),r=o({}),v=o(!1),z=o([]),d=o(0),n=o({total:0,currentPage:1,pageSize:12,ascs:[],descs:"create_time"}),P=o(!1),g=o(null),h=o([]);function E(){v.value=!0,Pe({total:0,page:1,size:100,ascs:[],sort:"create_time,desc"}).then(e=>{v.value=!1,f.value=e,f.value.unshift({id:"-1",name:"\u5168\u90E8\u5206\u7EC4"}),u({index:0})})}function u(e){h.value=[];const a=Number(e.index);r.value=f.value[a],r.value.index=a,y.value=r.value.id,n.value.currentPage=1,n.value.total=0,r.value.id!="-1"?g.value=r.value.id:g.value=null,C(n.value)}function C(e){P.value=!0,ke(Object.assign({page:e.currentPage-1,size:e.pageSize,descs:e.descs,ascs:e.ascs,sort:"create_time,desc"},{groupId:g.value})).then(a=>{n.value.total=a.total,n.value.currentPage=e.currentPage,n.value.pageSize=e.pageSize,z.value=a.list,P.value=!1}).catch(a=>{P.value=!1})}function L(e){n.value.currentPage=1,n.value.pageSize=e,C(this.page)}function O(e){n.value.currentPage=e,C(n.value)}function R(e){}function H(e,a,c){Ne({type:"1",groupId:g.value!="-1"?g.value:null,name:a.name,url:e.data}).then(()=>{d.value++,c.length===d.value&&C(n.value)})}function q(e){const a=e.type==="image/jpeg"||e.type==="image/png"||e.type==="image/gif"||e.type==="image/jpg",c=e.size/1024/1024<2;return a?(c||this.$message.error("\u4E0A\u4F20\u5934\u50CF\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 2MB!"),a&&c):(this.$message.error("\u4E0A\u4F20\u56FE\u7247\u53EA\u80FD\u662F JPG\u3001JPEG\u3001PNG\u3001GIF \u683C\u5F0F!"),!1)}function D(){b.value=!1;let e="";h.value.forEach(a=>{e+='<img src="'+a+'">'}),nowEditor.dialog.close(!0),nowEditor.editor.setContent(e,!0)}return oe(()=>{E()}),(e,a)=>{const c=ce,Z=pe,K=de,Q=re,N=ye,W=_e,V=he,X=ve,Y=ze,ee=xe,U=Se,ae=ge,te=Ie,le=fe,ne=be,A=me;return p(),T("div",null,[x("div",null,[l(ne,null,{default:t(()=>[l(Q,{width:"100px"},{default:t(()=>[x("div",Ve,[l(c,{class:"el-icon-plus",size:"small",onClick:a[0]||(a[0]=i=>{I.prompt("\u8BF7\u8F93\u5165\u5206\u7EC4\u540D","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88"}).then(({value:s})=>{Ee({name:s}).then(function(){E()})}).catch(()=>{})})},{default:t(()=>[_(" \u6DFB\u52A0\u5206\u7EC4 ")]),_:1})]),G((p(),S(K,{modelValue:y.value,"onUpdate:modelValue":a[1]||(a[1]=i=>y.value=i),"tab-position":"left",onTabClick:u},{default:t(()=>[(p(!0),T(M,null,$(f.value,i=>(p(),S(Z,{key:i.id,name:i.id},{label:t(()=>[x("span",null,F(i.name),1)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])),[[A,v.value]])]),_:1}),l(le,null,{default:t(()=>[l(U,null,{header:t(()=>[x("div",null,[l(V,null,{default:t(()=>[l(N,{span:12},{default:t(()=>[x("span",null,F(r.value.name),1),r.value.id!="-1"?(p(),T("span",je,[l(c,{size:"small",type:"text",class:"el-icon-edit",style:{"margin-left":"10px"},onClick:a[2]||(a[2]=i=>{return s=r.value,void I.prompt("\u8BF7\u8F93\u5165\u5206\u7EC4\u540D","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",inputValue:s.name}).then(({value:j})=>{Te({id:s.id,name:j}).then(function(){s.name=j,f.value[s.index]=s})}).catch(()=>{});var s})},{default:t(()=>[_("\u91CD\u547D\u540D")]),_:1}),l(c,{size:"small",type:"text",class:"el-icon-delete",style:{"margin-left":"10px",color:"red"},onClick:a[3]||(a[3]=i=>{return s=r.value,void I.confirm("\u662F\u5426\u786E\u8BA4\u5220\u9664\u8BE5\u5206\u7EC4\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(function(){Be(s.id).then(function(){E()})});var s})},{default:t(()=>[_("\u5220\u9664")]),_:1})])):J("",!0)]),_:1}),l(N,{span:12,style:{"text-align":"right"}},{default:t(()=>[l(W,{action:we("https://meeting.ai-centre.org/admin-api/infra/file/upload"),headers:k.value,"file-list":[],"on-progress":R,"before-upload":q,"on-success":H,data:{type:1},multiple:""},{default:t(()=>[l(c,{size:"small",type:"primary"},{default:t(()=>[_("\u6279\u91CF\u4E0A\u4F20")]),_:1})]),_:1},8,["action","headers"])]),_:1})]),_:1})])]),default:t(()=>[G((p(),T("div",null,[z.value.length<=0?(p(),S(X,{key:0,title:"\u6682\u65E0\u6570\u636E",type:"info",closable:!1,center:"","show-icon":""})):J("",!0),l(ae,{modelValue:h.value,"onUpdate:modelValue":a[4]||(a[4]=i=>h.value=i),max:w.num-m.value.length},{default:t(()=>[l(V,{gutter:5},{default:t(()=>[(p(!0),T(M,null,$(z.value,(i,s)=>(p(),S(N,{key:s,span:4},{default:t(()=>[l(U,{"body-style":{padding:"5px"}},{default:t(()=>[l(Y,{style:{width:"100%",height:"100px"},src:i.url,fit:"contain","preview-src-list":[i.url],"z-index":9999},null,8,["src","preview-src-list"]),x("div",null,[l(ee,{class:"material-name",label:i.url},{default:t(()=>[_(" \u9009\u62E9 ")]),_:2},1032,["label"]),l(V,null,{default:t(()=>[l(N,{span:24,class:"col-do"},{default:t(()=>[l(c,{type:"text",size:"medium",onClick:j=>function(ue){I.confirm("\u662F\u5426\u786E\u8BA4\u5220\u9664\u8BE5\u7D20\u6750\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(function(){Ce(ue.id).finally(function(){C(n.value)})})}(i)},{default:t(()=>[_("\u5220\u9664")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue","max"]),l(te,{"current-page":n.value.currentPage,"onUpdate:currentPage":a[5]||(a[5]=i=>n.value.currentPage=i),"page-sizes":[12,24],"page-size":n.value.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:n.value.total,class:"pagination",onSizeChange:L,onCurrentChange:O},null,8,["current-page","page-size","total"])])),[[A,P.value]])]),_:1})]),_:1})]),_:1}),x("span",Ue,[l(c,{type:"primary",onClick:D},{default:t(()=>[_("\u786E \u5B9A")]),_:1})])])])}}},[["__scopeId","data-v-0a064fcb"]]);export{Ae as default};
