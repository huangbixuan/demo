import{d as Ve,r as i,b as _e,z as Ie,A as ae,a4 as le,f as Ne,J as B,o as r,w as d,h as t,B as we,a as s,C as xe,c4 as Ce,x as U,g as a,t as c,c as m,F as S,G as z,N as Ue,l as h,M as Se,S as ze,v as Fe,y as Ae,i as Te,cm as je,$ as qe,q as Ee,s as Oe,_ as Pe}from"./index-QQaZ7rbf.js";import{E as Je}from"./el-drawer-PTxXA9Gz.js";import{_ as Re}from"./index.vue_vue_type_script_setup_true_lang-CtP16Cnh.js";import{E as Be}from"./el-empty-DtZU1JEc.js";import{_ as Ge}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CerucUbi.js";import{g as Le}from"./category-Cad002jB.js";import{g as Me}from"./product-Ckxj6eZ5.js";import{b as Qe,c as Xe,d as $e,u as De,e as He,j as Ke,f as We}from"./index-DCAaTwVR.js";import"./index-BctfKmg_.js";import"./index-D_95hI5s.js";const Ye={style:{display:"flex","flex-direction":"row",width:"100%"}},Ze={class:"cart-container"},ea={class:"title"},aa=(F=>(Ee("data-v-a3b87c7a"),F=F(),Oe(),F))(()=>a("div",{class:"logo"}," \u6536\u94F6\u5458: ",-1)),la={class:"member-info"},sa={class:"name"},ta={class:"carts"},oa={class:"tab"},ia={key:0,class:"cart-list"},da=["src"],ua={class:"info"},ra={class:"name"},ca={class:"spec"},na={class:"item"},ma={class:"num"},pa={class:"option"},va=["onClick"],fa={class:"total"},ya={key:1,class:"empty"},ga={class:"footer"},ha={class:"number"},ka={class:"total-num"},ba={class:"num"},Va={class:"total-price"},_a={class:"num"},Ia={class:"options"},Na={style:{width:"300px","margin-top":"10px"}},wa={class:"main-list"},xa={class:"title"},Ca={class:"goods-list"},Ua=["onClick"],Sa=["src"],za={class:"goods-name"},Fa={class:"goods-price"},Aa={class:"goods-info"},Ta={class:"name"},ja={class:"price"},qa={class:"num"},Ea={class:"spec-list"},Oa={class:"spec-name"},Pa={class:"values"},Ja=["onClick"],Ra={class:"dialog-footer"},Ba=Pe(Ve({__name:"help22-bak",setup(F,{expose:se}){const I=i(!1),G=i(""),te=_e(),b=Ie(),n=i(0),V=i(0),N=i(!1);i(!0);const L=i(1);i([]);const O=ae({name:void 0,shopId:void 0}),p=ae({pageNo:1,pageSize:8,storeName:null,cateId:null,isShow:1,shopId:void 0}),oe=i(),P=i(0),M=i([]),J=i([]);i({});const y=i({}),A=i(1),w=i([]),T=i({}),g=i([]),j=i({}),Q=i({});se({open:async(o,e)=>{I.value=!0,G.value="\u684C\u53F0\uFF1A"+o.number,j.value=o,e.id&&(Q.value=e,V.value=e.deskPeople),ue()}});const ie=le(()=>g.value.reduce((o,e)=>o+e.cartNum,0)),de=le(()=>{let o=g.value.reduce((e,k)=>e+k.cartNum*k.price,0);return parseFloat(o).toFixed(2)}),ue=async()=>{try{n.value=j.value.shopId,O.shopId=n.value,p.shopId=n.value,re(),x(),q(n.value)}finally{}},re=async()=>{try{const o=await Le(O);M.value=o}finally{}},x=async()=>{try{const o=await Me(p);J.value=o.list,L.value=o.total}finally{}},ce=(o,e)=>{o.paneName>0?(p.cateId=o.paneName,x()):(p.cateId=null,x())},X=()=>{N.value=!1},q=async o=>{const e=await $e({shopId:o});g.value=e},ne=i();i();const me=async()=>{let o={uidType:"admin",orderId:Q.value.orderId,shopId:n.value,productId:[],spec:[],number:[],remark:"",mobile:"",orderType:"desk",gettime:0,payType:"cash",deductionPrice:0,uid:0,cartIds:[],deskId:j.value.id,deskNumber:j.value.number,deskPeople:V.value};g.value.forEach((e,k)=>{o.productId.push(e.productId),o.spec.push(e.sku),o.number.push(e.cartNum),o.cartIds.push(e.id)}),await We(o)&&(I.value=!1)};return Ne(()=>{}),(o,e)=>{const k=Ce,R=xe,$=we,D=Ge,H=Ue,K=Be,_=Se,pe=ze,W=Ae,ve=Fe,fe=je,ye=Re,ge=Je;return r(),B(ge,{modelValue:s(I),"onUpdate:modelValue":e[13]||(e[13]=l=>U(I)?I.value=l:null),title:s(G),size:"90%"},{default:d(()=>[t(D,null,{default:d(()=>[t($,{model:s(O),ref_key:"queryFormRef",ref:oe,inline:!0,"label-width":"68px"},{default:d(()=>[t(R,{label:"\u5C31\u9910\u4EBA\u6570",prop:"orderId"},{default:d(()=>[t(k,{modelValue:s(V),"onUpdate:modelValue":e[0]||(e[0]=l=>U(V)?V.value=l:null),placeholder:"\u8BF7\u8F93\u5165\u4EBA\u6570"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),t(D,null,{default:d(()=>[a("div",Ye,[a("div",null,[a("div",Ze,[a("div",ea,[aa,a("div",la,[a("span",sa,c(s(te).getUser.nickname),1)])]),a("div",ta,[a("div",null,[a("div",oa,[s(g).length>0?(r(),m("div",ia,[(r(!0),m(S,null,z(s(g),(l,u)=>(r(),m("div",{class:"cart-item",key:u},[a("img",{class:"image",src:l.image},null,8,da),a("div",ua,[a("div",ra,c(l.storeName),1),a("div",ca,[a("span",na,c(l.sku),1)]),a("div",ma,[t(k,{class:"input",onChange:v=>(async f=>{f.cartNum<1?b.error("\u6570\u91CF\u4E0D\u80FD\u5C0F\u4E8E1\u54E6"):await De(f)})(l),modelValue:l.cartNum,"onUpdate:modelValue":v=>l.cartNum=v,min:1,max:1e3},null,8,["onChange","modelValue","onUpdate:modelValue"])])]),a("div",pa,[a("div",{class:"remove",onClick:v=>(async f=>{await He({id:f}),q(n.value)})(l.id)},[t(H,{icon:"ep:delete",class:"mr-5px"})],8,va),a("div",fa,"\uFFE5"+c(l.price),1)])]))),128))])):(r(),m("div",ya,[t(K,{description:"\u6682\u65E0\u7ED3\u7B97\u5546\u54C1","image-size":40})]))])])]),a("div",ga,[a("div",ha,[a("div",ka,[h("\u603B\u4EF6\u6570\uFF1A"),a("b",ba,c(s(ie)),1)]),a("div",Va,[h("\u603B\u91D1\u989D\uFF1A"),a("b",_a,"\uFFE5"+c(s(de)),1)])]),a("div",Ia,[a("div",Na,[t(_,{type:"primary",round:"",onClick:e[1]||(e[1]=l=>{ne.value.open(n.value)})},{default:d(()=>[h("\u53D6\u5355")]),_:1}),t(_,{type:"warning",round:"",onClick:e[2]||(e[2]=l=>(async()=>{let u=g.value.map(v=>v.id);u.length!=0?(await Ke({ids:u.toString()}),q(n.value)):b.error("\u6682\u65E0\u5546\u54C1\u6302\u5355")})())},{default:d(()=>[h("\u6302\u5355")]),_:1}),t(_,{type:"danger",round:"",onClick:e[3]||(e[3]=l=>{g.value.length!=0?V.value!=0?me():b.error("\u5C31\u9910\u4EBA\u6570\u5FC5\u987B\u5927\u4E8E0\uFF01"):b.error("\u8BF7\u5148\u52A0\u5165\u5546\u54C1\uFF01")})},{default:d(()=>[h("\u53BB\u4E0B\u5355")]),_:1})])])])])]),a("div",null,[a("div",wa,[a("div",xa,[t($,{class:"search-form",ref:"searchForm",inline:!0},{default:d(()=>[t(R,{class:"form-item",label:"",prop:"keyword"},{default:d(()=>[t(pe,{"prefix-icon":"el-icon-full-screen",modelValue:s(p).storeName,"onUpdate:modelValue":e[4]||(e[4]=l=>s(p).storeName=l),class:"input-item",placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u5173\u952E\u5B57\uFF1A\u5546\u54C1\u540D\u79F0",clearable:"",maxlength:"100"},null,8,["modelValue"])]),_:1}),t(R,null,{default:d(()=>[t(_,{class:"search-goods",type:"danger",onClick:e[5]||(e[5]=l=>{x()})},{default:d(()=>[t(H,{icon:"ep:search",class:"mr-5px"}),h("\u67E5\u8BE2\u5546\u54C1")]),_:1})]),_:1})]),_:1},512),t(ve,{class:"tab-box",modelValue:s(P),"onUpdate:modelValue":e[6]||(e[6]=l=>U(P)?P.value=l:null),type:"card",onTabClick:ce},{default:d(()=>[t(W,{label:"\u5168\u90E8",name:0}),(r(!0),m(S,null,z(s(M),(l,u)=>(r(),B(W,{label:l.name,name:l.id,key:u},null,8,["label","name"]))),128))]),_:1},8,["modelValue"])]),a("div",Ca,[(r(!0),m(S,null,z(s(J),(l,u)=>(r(),m("div",{class:"goods-item",key:u},[a("div",{class:"item",onClick:v=>(async f=>{N.value=!0;const Y=await Qe({id:f});y.value=Y,w.value=[]})(l.id)},[a("img",{class:"image",lazy:"",src:l.image},null,8,Sa),a("div",za,c(l.storeName),1),a("div",Fa,"\uFFE5"+c(l.price),1)],8,Ua)]))),128)),t(fe,{title:"\u9009\u62E9\u5546\u54C1\u89C4\u683C",modelValue:s(N),"onUpdate:modelValue":e[10]||(e[10]=l=>U(N)?N.value=l:null),class:"common-dialog","append-to-body":""},{footer:d(()=>[a("div",Ra,[t(_,{type:"primary",class:"main-button",onClick:e[8]||(e[8]=l=>(async()=>{if(Object.keys(T.value).length==0)return void b.error("\u8BF7\u9009\u62E9\u89C4\u683C\uFF01");if(n.value==0)return void b.error("\u8BF7\u9009\u62E9\u95E8\u5E97\uFF01");let u={uid:0,shopId:n.value,productId:T.value.productId,productAttrUnique:T.value.unique,cartNum:A.value};await Xe(u),q(n.value),X()})())},{default:d(()=>[h("\u52A0\u5165\u7ED3\u7B97")]),_:1}),t(_,{onClick:e[9]||(e[9]=l=>X())},{default:d(()=>[h("\u53D6 \u6D88")]),_:1})])]),default:d(()=>[a("div",Aa,[a("div",Ta,c(s(y).storeName),1),a("div",ja,"\uFFE5"+c(s(y).price),1),a("div",qa,[t(k,{class:"input",modelValue:s(A),"onUpdate:modelValue":e[7]||(e[7]=l=>U(A)?A.value=l:null),min:1,max:1e3},null,8,["modelValue"])]),a("div",Ea,[(r(!0),m(S,null,z(s(y).productAttr,(l,u)=>(r(),m("div",{class:"spec-item",key:u},[a("div",Oa,c(l.attrName),1),a("div",Pa,[(r(!0),m(S,null,z(l.attrValueArr,(v,f)=>(r(),m("span",{class:qe(["value",{active:v==s(w)[u]}]),key:f,onClick:Y=>((Z,he)=>{let E="";w.value[Z]=y.value.productAttr[Z].attrValueArr[he],E=w.value.join(",");let C=y.value.productValue[E];if(!C){let ee=JSON.parse(JSON.stringify(w.value));ee.sort((ke,be)=>ke.localeCompare(be)),E=ee.join(","),C=y.value.productValue[E]}C&&(T.value=C,y.value.price=parseFloat(C.price).toFixed(2))})(u,f)},c(v),11,Ja))),128))])]))),128))])])]),_:1},8,["modelValue"]),s(J).length==0?(r(),B(K,{key:0,description:"\u6682\u65E0\u5546\u54C1..."})):Te("",!0)]),a("div",null,[t(ye,{total:s(L),page:s(p).pageNo,"onUpdate:page":e[11]||(e[11]=l=>s(p).pageNo=l),limit:s(p).pageSize,"onUpdate:limit":e[12]||(e[12]=l=>s(p).pageSize=l),onPagination:x},null,8,["total","page","limit"])])])])])]),_:1})]),_:1},8,["modelValue","title"])}}}),[["__scopeId","data-v-a3b87c7a"]]);export{Ba as default};
