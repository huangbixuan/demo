import{d as le,b as se,z as de,r as d,aj as ne,a4 as ie,dg as ue,A as pe,aO as fe,dr as me,f as ce,cg as ye,R as ve,c as u,o,h as t,w as r,B as ge,a as n,C as ke,D as he,F as I,G as T,J as p,K as _e,M as be,l as h,N as xe,c2 as Ie,x as A,O as w,g as s,a7 as we,v as Ce,y as Oe,m as Ve,E as Se,t as i,q as De,s as Ne,_ as Re}from"./index-QQaZ7rbf.js";import{E as Le}from"./el-empty-DtZU1JEc.js";import{_ as Ue}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CerucUbi.js";import{a as ze}from"./index-AwhozRCE.js";import{g as Pe}from"./index-D-uYqOkD.js";import Fe from"./OrderSend-DBRvLAbS.js";import Ee from"./OrderDetail-yVQkAKN5.js";import Te from"./Order-8j7yK7oB.js";import{f as Ae}from"./formatTime-esrXlwGe.js";import{E as Be}from"./index-D_95hI5s.js";import"./Dialog.vue_vue_type_style_index_0_lang-BZRnyNPI.js";import"./el-drawer-PTxXA9Gz.js";import"./el-timeline-item-CFJSbWRQ.js";import"./el-image-DHi7RmhO.js";import"./el-avatar-Bk2V5BPv.js";import"./el-descriptions-item-BBtnvGnE.js";import"./index.vue_vue_type_script_setup_true_lang-CtP16Cnh.js";import"./index-BctfKmg_.js";import"./el-dropdown-item-D1XCTc1V.js";import"./StoreOrderForm.vue_vue_type_script_setup_true_lang-CpsUpqAP.js";import"./OrderSendInfo-qp9YJrZl.js";const C=m=>(De("data-v-2fb956c8"),m=m(),Ne(),m),Je={id:"buttonAudio",src:"/voice_new_order.mp3",controls:""},je={class:"card-header",style:{"text-align":"center"}},qe={style:{color:"#ffffff","text-align":"center"}},Ke={key:0},Ge=C(()=>s("div",{style:{"font-size":"20px","font-weight":"bolder"}},"\u5916\u5356",-1)),Me={style:{"margin-top":"5px"}},$e={key:1},He=C(()=>s("div",{style:{"font-size":"20px","font-weight":"bolder"}},"\u81EA\u53D6",-1)),Qe={style:{"margin-top":"5px"}},We={key:2},Xe=C(()=>s("div",{style:{"font-size":"20px","font-weight":"bolder"}},"\u5802\u98DF",-1)),Ye={style:{"margin-top":"5px"}},Ze={style:{"font-size":"20px","font-weight":"bolder"}},ea={key:0},aa={key:1},ta={style:{"margin-top":"30px"}},ra={style:{"text-align":"center"}},oa=Re(le({__name:"work",setup(m){const O=se(),B=de(),J=d("https://meeting.ai-centre.org/infra/ws".replace("http","ws")+"?token="+ne());ie(()=>j.value==="OPEN");const{status:j,data:c,close:q}=ue(J.value,{autoReconnect:!1,heartbeat:!0}),V=d(!0),K=d(0),_=d([]),f=pe({pageNo:1,pageSize:50,orderStatus:1,deskStatus:"empty",type:"work",shopId:void 0}),S=d(),y=d("first"),v=d(!0),D=d([]);d([]),fe(()=>{if(c.value)try{if(c.value==="pong")return;const a=JSON.parse(c.value),l=a.type,b=JSON.parse(a.content);if(l==="sync-order-msg")return void(O.getUser.shopId!=0&&O.getUser.shopId!=b.shopId||M())}catch{B.error("\u5904\u7406\u6D88\u606F\u53D1\u751F\u5F02\u5E38\uFF1A"+c.value)}}),new URL(decodeURIComponent(location.href)).pathname.split("=").length==2&&(y.value="second");const G=(a,l)=>{},g=async()=>{V.value=!0;try{const a=await ze(f);_.value=a.list,K.value=a.total}finally{V.value=!1}},M=()=>{v.value&&(me({title:"\u65B0\u8BA2\u5355\u901A\u77E5",message:"\u4F60\u6709\u4E2A\u65B0\u7684\u8BA2\u5355\u54E6\uFF0C\u8BF7\u6CE8\u610F\u67E5\u770B\uFF01",type:"success",duration:8e3}),document.getElementById("buttonAudio").play().catch(a=>{})),g()},N=()=>{f.pageNo=1,g()},$=()=>{S.value.resetFields(),N()},R=d(),L=d(),U=d(),z=(a,l)=>{a=="orderSend"?R.value.open(a,l):a=="orderDetail"?L.value.open(a,l):a=="order"&&U.value.open(a,l)};return ce(()=>{g(),(async()=>{try{const a=await Pe();D.value=a}finally{}})()}),ye(()=>{q()}),(a,l)=>{const b=_e,H=he,x=ke,P=xe,k=be,Q=Ie,W=ge,F=Ue,X=Be,Y=Se,Z=Ve,ee=Le,ae=Oe,te=Ce,E=ve("hasPermi");return o(),u(I,null,[t(F,null,{default:r(()=>[t(W,{class:"-mb-15px",model:n(f),ref_key:"queryFormRef",ref:S,inline:!0,"label-width":"68px"},{default:r(()=>[t(x,{label:"\u9009\u62E9\u95E8\u5E97",prop:"orderId"},{default:r(()=>[t(H,{modelValue:n(f).shopId,"onUpdate:modelValue":l[0]||(l[0]=e=>n(f).shopId=e),class:"!w-240px"},{default:r(()=>[(o(!0),u(I,null,T(n(D),e=>(o(),p(b,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(x,null,{default:r(()=>[t(k,{onClick:N},{default:r(()=>[t(P,{icon:"ep:search",class:"mr-5px"}),h(" \u641C\u7D22")]),_:1}),t(k,{onClick:$},{default:r(()=>[t(P,{icon:"ep:refresh",class:"mr-5px"}),h(" \u91CD\u7F6E")]),_:1})]),_:1}),t(x,{label:""},{default:r(()=>[t(Q,{modelValue:n(v),"onUpdate:modelValue":l[1]||(l[1]=e=>A(v)?v.value=e:null),"active-text":"\u8BA2\u5355\u63D0\u9192\u5F00\u542F\u4E2D","inactive-text":"\u8BA2\u5355\u63D0\u9192\u5173\u95ED\u4E2D"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),t(F,null,{default:r(()=>[w(s("audio",Je,null,512),[[we,!1]]),t(te,{modelValue:n(y),"onUpdate:modelValue":l[2]||(l[2]=e=>A(y)?y.value=e:null),onTabClick:G},{default:r(()=>[t(ae,{label:"\u6700\u8FD1\u8BA2\u5355",name:"first"},{default:r(()=>[n(_).length>0?(o(),p(Z,{key:0,gutter:24},{default:r(()=>[(o(!0),u(I,null,T(n(_),(e,re)=>(o(),p(Y,{span:6,key:re},{default:r(()=>[s("div",null,[t(X,{class:"box-card","body-style":{background:"#0a5ba6"}},{header:r(()=>[s("div",je," \u8BA2\u5355\u53F7:"+i(e.orderId),1)]),default:r(()=>[s("div",qe,[e.orderType=="takeout"?(o(),u("div",Ke,[Ge,s("div",Me,"\u8054\u7CFB\u7535\u8BDD:"+i(e.userPhone),1)])):e.orderType=="takein"?(o(),u("div",$e,[He,s("div",Qe,"\u53D6\u9910\u53F7:"+i(e.numberId),1)])):(o(),u("div",We,[Xe,s("div",Ye,"\u684C\u53F7:"+i(e.deskNumber)+",\u4EBA\u6570:"+i(e.deskPeople),1)])),s("div",Ze,[e.storeOrderCartInfoDOList.length>1?(o(),u("span",ea," \u591A\u4EFD\u83DC\u54C1\uFF0C\u8BF7\u67E5\u770B\u8BE6\u60C5 ")):(o(),u("span",aa,i(e.storeOrderCartInfoDOList[0].title)+"\xD7"+i(e.storeOrderCartInfoDOList[0].number)+" "+i(e.storeOrderCartInfoDOList[0].spec),1))]),s("div",ta,[w((o(),p(k,{type:"primary",onClick:oe=>z("orderDetail",e.id)},{default:r(()=>[h("\u8BE6\u60C5")]),_:2},1032,["onClick"])),[[E,["order:store-order:update"]]]),w((o(),p(k,{type:"primary",onClick:oe=>z("orderSend",e.id)},{default:r(()=>[h("\u51FA\u5355")]),_:2},1032,["onClick"])),[[E,["order:store-order:update"]]])])])]),footer:r(()=>[s("div",ra,"\u4E0B\u5355\u65F6\u95F4:"+i(n(Ae)(e.createTime)),1)]),_:2},1024)])]),_:2},1024))),128))]),_:1})):(o(),p(ee,{key:1,description:"\u6682\u65E0\u8BA2\u5355\u6570\u636E"}))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(Fe,{ref_key:"formRef1",ref:R,onSuccess:g},null,512),t(Ee,{ref_key:"formRef4",ref:L},null,512),t(Te,{ref_key:"order",ref:U},null,512)],64)}}}),[["__scopeId","data-v-2fb956c8"]]);export{oa as default};
