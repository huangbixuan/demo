import{aU as y,d as Y,z as j,r as p,A as G,R as L,c as Q,o as N,h as l,w as s,B as W,a as t,C as X,v as Z,x as U,m as $,E as ee,O as ae,i as le,J as te,M as se,l as c,N as oe,y as re,cm as ue,F as pe}from"./index-QQaZ7rbf.js";import{_ as ie}from"./ReplyForm.vue_vue_type_script_setup_true_lang-Dm0nRO-f.js";import{R as k}from"./TabNews-mo0oRnuR.js";import"./index.vue_vue_type_script_setup_true_lang-CtP16Cnh.js";import"./el-image-DHi7RmhO.js";import"./main-B8cmAKC9.js";import"./main-CZZklA9W.js";import"./main.vue_vue_type_script_setup_true_lang-CtNEQeQ-.js";import"./main-BSp1ppd9.js";import"./useUpload-uA0mAQ_g.js";import"./TabImage-DEdi2Zg_.js";import"./TabVoice-CyqrFiNP.js";import"./TabVideo-C--YXe8L.js";import"./main-DihDTKAv.js";import{_ as ne}from"./main.vue_vue_type_script_setup_true_lang-CdYlBeNF.js";import{_ as A}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CerucUbi.js";import{_ as de}from"./ReplyTable.vue_vue_type_script_setup_true_lang-CQPfGSkv.js";import{M as v}from"./types-CAO1T7C7.js";import"./index-BctfKmg_.js";import"./index-BvM_QHiW.js";import"./index-COkZqY69.js";import"./formatTime-esrXlwGe.js";import"./TabText.vue_vue_type_script_setup_true_lang-GGhtc3Am.js";import"./TabMusic.vue_vue_type_script_setup_true_lang-Czrc2u0K.js";import"./index-CKlW-SbG.js";import"./index-D_95hI5s.js";import"./DictTag.vue_vue_type_script_lang-DFL6gWod.js";import"./color-xEzN0Pg5.js";import"./main--NwUXV6B.js";const me=Y({name:"MpAutoReply",__name:"index",setup(ce){const f=j(),q=p(-1),u=p(v.Keyword),h=p(!0),D=p(0),w=p([]),I=p(null),i=G({pageNo:1,pageSize:10,accountId:q}),b=p(!1),n=p(!1),r=p({}),o=p({type:k.Text,accountId:-1}),F=e=>{q.value=e,o.value.accountId=e,i.pageNo=1,M()},M=async()=>{h.value=!0;try{const a=await(e={...i,type:u.value},y.get({url:"/mp/auto-reply/page",params:e}));w.value=a.list,D.value=a.total}finally{h.value=!1}var e},K=e=>{u.value=e,i.pageNo=1,M()},O=()=>{T(),o.value={type:k.Text,accountId:i.accountId},b.value=!0,n.value=!0},R=async e=>{T();const a=await(m=>y.get({url:"/mp/auto-reply/get?id="+m}))(e);r.value={...a},delete r.value.responseMessageType,delete r.value.responseContent,delete r.value.responseMediaId,delete r.value.responseMediaUrl,delete r.value.responseDescription,delete r.value.responseArticles,o.value={type:a.responseMessageType,accountId:i.accountId,content:a.responseContent,mediaId:a.responseMediaId,url:a.responseMediaUrl,title:a.responseTitle,description:a.responseDescription,thumbMediaId:a.responseThumbMediaId,thumbMediaUrl:a.responseThumbMediaUrl,articles:a.responseArticles,musicUrl:a.responseMusicUrl,hqMusicUrl:a.responseHqMusicUrl},b.value=!1,n.value=!0},z=async e=>{await f.confirm("\u662F\u5426\u786E\u8BA4\u5220\u9664\u6B64\u6570\u636E?"),await(a=>y.delete({url:"/mp/auto-reply/delete?id="+a}))(e),await M(),f.success("\u5220\u9664\u6210\u529F")},B=async()=>{var m;await((m=I.value)==null?void 0:m.validate());const e={...r.value};var a;e.responseMessageType=o.value.type,e.responseContent=o.value.content,e.responseMediaId=o.value.mediaId,e.responseMediaUrl=o.value.url,e.responseTitle=o.value.title,e.responseDescription=o.value.description,e.responseThumbMediaId=o.value.thumbMediaId,e.responseThumbMediaUrl=o.value.thumbMediaUrl,e.responseArticles=o.value.articles,e.responseMusicUrl=o.value.musicUrl,e.responseHqMusicUrl=o.value.hqMusicUrl,r.value.id!==void 0?(await(a=e,y.put({url:"/mp/auto-reply/update",data:a})),f.success("\u4FEE\u6539\u6210\u529F")):(await(x=>y.post({url:"/mp/auto-reply/create",data:x}))(e),f.success("\u65B0\u589E\u6210\u529F")),n.value=!1,await M()},T=()=>{var e;r.value={id:void 0,accountId:i.accountId,type:u.value,requestKeyword:void 0,requestMatch:u.value===v.Keyword?1:void 0,requestMessageType:void 0},(e=I.value)==null||e.resetFields()},H=()=>{n.value=!1,T()};return(e,a)=>{const m=X,x=W,g=oe,C=se,E=ee,_=$,V=re,J=Z,P=ue,S=L("hasPermi");return N(),Q(pe,null,[l(t(A),null,{default:s(()=>[l(x,{class:"-mb-15px",model:t(i),inline:!0,"label-width":"68px"},{default:s(()=>[l(m,{label:"\u516C\u4F17\u53F7",prop:"accountId"},{default:s(()=>[l(t(ne),{onChange:F})]),_:1})]),_:1},8,["model"])]),_:1}),l(t(A),null,{default:s(()=>[l(J,{modelValue:t(u),"onUpdate:modelValue":a[0]||(a[0]=d=>U(u)?u.value=d:null),onTabChange:K},{default:s(()=>[l(_,{gutter:10,class:"mb8"},{default:s(()=>[l(E,{span:1.5},{default:s(()=>[t(u)!==t(v).Follow||t(w).length<=0?ae((N(),te(C,{key:0,type:"primary",plain:"",onClick:O},{default:s(()=>[l(g,{icon:"ep:plus"}),c("\u65B0\u589E ")]),_:1})),[[S,["mp:auto-reply:create"]]]):le("",!0)]),_:1})]),_:1}),l(V,{name:t(v).Follow},{label:s(()=>[l(_,{align:"middle"},{default:s(()=>[l(g,{icon:"ep:star",class:"mr-2px"}),c(" \u5173\u6CE8\u65F6\u56DE\u590D")]),_:1})]),_:1},8,["name"]),l(V,{name:t(v).Message},{label:s(()=>[l(_,{align:"middle"},{default:s(()=>[l(g,{icon:"ep:chat-line-round",class:"mr-2px"}),c(" \u6D88\u606F\u56DE\u590D")]),_:1})]),_:1},8,["name"]),l(V,{name:t(v).Keyword},{label:s(()=>[l(_,{align:"middle"},{default:s(()=>[l(g,{icon:"fa:newspaper-o",class:"mr-2px"}),c(" \u5173\u952E\u8BCD\u56DE\u590D")]),_:1})]),_:1},8,["name"])]),_:1},8,["modelValue"]),l(de,{loading:t(h),list:t(w),"msg-type":t(u),onOnUpdate:R,onOnDelete:z},null,8,["loading","list","msg-type"]),l(P,{title:t(b)?"\u65B0\u589E\u81EA\u52A8\u56DE\u590D":"\u4FEE\u6539\u81EA\u52A8\u56DE\u590D",modelValue:t(n),"onUpdate:modelValue":a[3]||(a[3]=d=>U(n)?n.value=d:null),width:"800px","destroy-on-close":""},{footer:s(()=>[l(C,{onClick:H},{default:s(()=>[c("\u53D6 \u6D88")]),_:1}),l(C,{type:"primary",onClick:B},{default:s(()=>[c("\u786E \u5B9A")]),_:1})]),default:s(()=>[l(ie,{modelValue:t(r),"onUpdate:modelValue":a[1]||(a[1]=d=>U(r)?r.value=d:null),reply:t(o),"onUpdate:reply":a[2]||(a[2]=d=>U(o)?o.value=d:null),"msg-type":t(u),ref_key:"formRef",ref:I},null,8,["modelValue","reply","msg-type"])]),_:1},8,["title","modelValue"])]),_:1})],64)}}});export{me as default};
