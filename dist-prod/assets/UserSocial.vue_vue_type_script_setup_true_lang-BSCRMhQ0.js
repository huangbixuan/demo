import{d as C,ai as l,a4 as F,b6 as O,J as f,o as p,M as T,az as X,a as I,w as y,i as U,l as v,N as j,t as _,_ as J,aU as w,z as L,r as b,Q as M,f as P,as as Q,h as u,p as V,g as x,c as N,F as R,n as $}from"./index-QQaZ7rbf.js";import{S}from"./constants-D0aoFN3l.js";import{g as A}from"./profile-CWZskjgo.js";const D=J(C({name:"XTextButton",__name:"XTextButton",props:{modelValue:l.bool.def(!1),loading:l.bool.def(!1),preIcon:l.string.def(""),postIcon:l.string.def(""),title:l.string.def(""),type:l.oneOf(["","primary","success","warning","danger","info"]).def("primary"),circle:l.bool.def(!1),round:l.bool.def(!1),plain:l.bool.def(!1),onClick:{type:Function,default:null}},setup(n){const g=n,m=F(()=>{const r=["title","preIcon","postIcon","onClick"],s={...O(),...g};for(const i in s)r.indexOf(i)!==-1&&delete s[i];return s});return(r,s)=>{const i=j,k=T;return p(),f(k,X({link:""},I(m),{onClick:n.onClick}),{default:y(()=>[n.preIcon?(p(),f(i,{key:0,icon:n.preIcon,class:"mr-1px"},null,8,["icon"])):U("",!0),v(" "+_(n.title?n.title:"")+" ",1),n.postIcon?(p(),f(i,{key:1,icon:n.postIcon,class:"mr-1px"},null,8,["icon"])):U("",!0)]),_:1},16,["onClick"])}}}),[["__scopeId","data-v-f7cd2dd8"]]),E=["src"],G={class:"mr-5"},H=C({name:"UserSocial",__name:"UserSocial",props:{activeName:{}},emits:["update:activeName"],setup(n,{emit:g}){const m=L(),r=b([]),s=b(),i=M(),k=g,q=()=>{const a=(t="type",new URL(decodeURIComponent(location.href)).searchParams.get(t)??"");var t;const e=i.query.code,o=i.query.state;e&&((d,c,h)=>w.post({url:"/system/social-user/bind",data:{type:d,code:c,state:h}}))(a,e,o).then(()=>{m.success("\u7ED1\u5B9A\u6210\u529F"),k("update:activeName","userSocial")})},z=a=>{const t=location.origin+"/user/profile?"+encodeURIComponent(`type=${a.type}`);((e,o)=>w.get({url:"/system/auth/social-auth-redirect?type="+e+"&redirectUri="+o}))(a.type,encodeURIComponent(t)).then(e=>{window.location.href=e})},B=async a=>{var t,e;await(t=a.type,e=a.openid,w.delete({url:"/system/social-user/unbind",data:{type:t,openid:e}}))&&(a.openid=void 0),m.success("\u89E3\u7ED1\u6210\u529F")};return P(async()=>{await(async()=>{var t;r.value=[];const a=await A();s.value=a;for(const e in S){const o={...S[e]};if(r.value.push(o),(t=s.value)==null?void 0:t.socialUsers){for(const d in s.value.socialUsers)if(o.type===s.value.socialUsers[d].type){o.openid=s.value.socialUsers[d].openid;break}}}})()}),Q(()=>i,()=>{q()},{immediate:!0}),(a,t)=>{const e=V,o=D,d=$;return p(),f(d,{data:I(r),"show-header":!1},{default:y(()=>[u(e,{fixed:"left",title:"\u5E8F\u53F7",type:"seq",width:"60"}),u(e,{align:"left",label:"\u793E\u4EA4\u5E73\u53F0",width:"120"},{default:y(({row:c})=>[x("img",{src:c.img,alt:"",class:"h-5 align-middle"},null,8,E),x("p",G,_(c.title),1)]),_:1}),u(e,{align:"center",label:"\u64CD\u4F5C"},{default:y(({row:c})=>[c.openid?(p(),N(R,{key:0},[v(" \u5DF2\u7ED1\u5B9A "),u(o,{class:"mr-5",title:"(\u89E3\u7ED1)",type:"primary",onClick:h=>B(c)},null,8,["onClick"])],64)):(p(),N(R,{key:1},[v(" \u672A\u7ED1\u5B9A "),u(o,{class:"mr-5",title:"(\u7ED1\u5B9A)",type:"primary",onClick:h=>z(c)},null,8,["onClick"])],64))]),_:1})]),_:1},8,["data"])}}});export{H as _};
