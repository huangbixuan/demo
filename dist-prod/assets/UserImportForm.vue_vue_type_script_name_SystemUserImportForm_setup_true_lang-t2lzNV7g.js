import{_ as F}from"./Dialog.vue_vue_type_style_index_0_lang-BZRnyNPI.js";import{d as q,z as A,r as o,J as B,o as I,w as s,h as c,ao as J,a as i,x as _,g as m,N as L,a6 as K,l as f,M,dq as O,aj as R}from"./index-QQaZ7rbf.js";import{e as S}from"./index-BiAqHivH.js";import{d as E}from"./download--D_IyRio.js";const G=m("div",{class:"el-upload__text"},[f("\u5C06\u6587\u4EF6\u62D6\u5230\u6B64\u5904\uFF0C\u6216"),m("em",null,"\u70B9\u51FB\u4E0A\u4F20")],-1),H={class:"el-upload__tip text-center"},P=m("span",null,"\u4EC5\u5141\u8BB8\u5BFC\u5165 xls\u3001xlsx \u683C\u5F0F\u6587\u4EF6\u3002",-1),Q=q({__name:"UserImportForm",emits:["success"],setup(T,{expose:g,emit:h}){const n=A(),u=o(!1),t=o(!1),v=o(),x=o(),d=o([]),y=o(0);g({open:()=>{u.value=!0,z()}});const N=async()=>{d.value.length!=0?(x.value={Authorization:"Bearer "+R(),"tenant-id":O()},t.value=!0,v.value.submit()):n.error("\u8BF7\u4E0A\u4F20\u6587\u4EF6")},D=h,b=r=>{if(r.code!==0)return n.error(r.msg),void(t.value=!1);const e=r.data;let a="\u4E0A\u4F20\u6210\u529F\u6570\u91CF\uFF1A"+e.createDeskNames.length+";";for(let l of e.createDeskNames)a+="< "+l+" >";a+="\u66F4\u65B0\u6210\u529F\u6570\u91CF\uFF1A"+e.updateDeskNames.length+";";for(const l of e.updateDeskNames)a+="< "+l+" >";a+="\u66F4\u65B0\u5931\u8D25\u6570\u91CF\uFF1A"+Object.keys(e.failureDeskNames).length+";";for(const l in e.failureDeskNames)a+="< "+l+": "+e.failureDeskNames[l]+" >";n.alert(a),D("success")},w=()=>{n.error("\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u60A8\u91CD\u65B0\u4E0A\u4F20\uFF01"),t.value=!1},z=()=>{d.value=[],t.value=!1,v.value.clearFiles()},C=()=>{n.error("\u6700\u591A\u53EA\u80FD\u4E0A\u4F20\u4E00\u4E2A\u6587\u4EF6\uFF01")},U=async()=>{const r=await S();E.excel(r,"\u6279\u91CF\u5BFC\u5165\u684C\u53F7\u6A21\u677F.xls")};return(r,e)=>{const a=L,l=K,V=J,k=M,j=F;return I(),B(j,{modelValue:i(u),"onUpdate:modelValue":e[2]||(e[2]=p=>_(u)?u.value=p:null),title:"\u5BFC\u5165",width:"400"},{footer:s(()=>[c(k,{disabled:i(t),type:"primary",onClick:N},{default:s(()=>[f("\u786E \u5B9A")]),_:1},8,["disabled"]),c(k,{onClick:e[1]||(e[1]=p=>u.value=!1)},{default:s(()=>[f("\u53D6 \u6D88")]),_:1})]),default:s(()=>[c(V,{ref_key:"uploadRef",ref:v,"file-list":i(d),"onUpdate:fileList":e[0]||(e[0]=p=>_(d)?d.value=p:null),action:"https://meeting.ai-centre.org/admin-api/desk/shop-desk/import?updateSupport="+i(y),"auto-upload":!1,disabled:i(t),headers:i(x),limit:1,"on-error":w,"on-exceed":C,"on-success":b,accept:".xlsx, .xls",drag:""},{tip:s(()=>[m("div",H,[P,c(l,{underline:!1,style:{"font-size":"12px","vertical-align":"baseline"},type:"primary",onClick:U},{default:s(()=>[f(" \u4E0B\u8F7D\u6A21\u677F ")]),_:1})])]),default:s(()=>[c(a,{icon:"ep:upload"}),G]),_:1},8,["file-list","action","disabled","headers"])]),_:1},8,["modelValue"])}}});export{Q as _};
