import{d as S,e as A,z as j,r,J as f,o as i,w as u,O as z,B,a as l,h as o,C as D,S as G,D as K,c as J,F as M,G as O,K as P,P as q,M as E,l as V,x as H}from"./index-QQaZ7rbf.js";import{_ as L}from"./Dialog.vue_vue_type_style_index_0_lang-BZRnyNPI.js";import{c as N,d as Q}from"./index-CLwSlqhw.js";import{b as T}from"./index-SZ6OHa9M.js";const W=S({name:"SystemUserAssignRoleForm",__name:"UserAssignRoleForm",emits:["success"],setup(X,{expose:b,emit:y}){const{t:k}=A(),I=j(),m=r(!1),n=r(!1),e=r({id:-1,nickname:"",username:"",roleIds:[]}),t=r(),v=r([]);b({open:async d=>{m.value=!0,h(),e.value.id=d.id,e.value.username=d.username,e.value.nickname=d.nickname,n.value=!0;try{e.value.roleIds=await N(d.id)}finally{n.value=!1}v.value=await T()}});const w=y,U=async()=>{if(t&&await t.value.validate()){n.value=!0;try{await Q({userId:e.value.id,roleIds:e.value.roleIds}),I.success(k("common.updateSuccess")),m.value=!1,w("success",!0)}finally{n.value=!1}}},h=()=>{var d;e.value={id:-1,nickname:"",username:"",roleIds:[]},(d=t.value)==null||d.resetFields()};return(d,s)=>{const p=G,c=D,F=P,g=K,x=B,_=E,C=L,R=q;return i(),f(C,{modelValue:l(m),"onUpdate:modelValue":s[4]||(s[4]=a=>H(m)?m.value=a:null),title:"\u5206\u914D\u89D2\u8272"},{footer:u(()=>[o(_,{disabled:l(n),type:"primary",onClick:U},{default:u(()=>[V("\u786E \u5B9A")]),_:1},8,["disabled"]),o(_,{onClick:s[3]||(s[3]=a=>m.value=!1)},{default:u(()=>[V("\u53D6 \u6D88")]),_:1})]),default:u(()=>[z((i(),f(x,{ref_key:"formRef",ref:t,model:l(e),"label-width":"80px"},{default:u(()=>[o(c,{label:"\u7528\u6237\u540D\u79F0"},{default:u(()=>[o(p,{modelValue:l(e).username,"onUpdate:modelValue":s[0]||(s[0]=a=>l(e).username=a),disabled:!0},null,8,["modelValue"])]),_:1}),o(c,{label:"\u7528\u6237\u6635\u79F0"},{default:u(()=>[o(p,{modelValue:l(e).nickname,"onUpdate:modelValue":s[1]||(s[1]=a=>l(e).nickname=a),disabled:!0},null,8,["modelValue"])]),_:1}),o(c,{label:"\u89D2\u8272"},{default:u(()=>[o(g,{modelValue:l(e).roleIds,"onUpdate:modelValue":s[2]||(s[2]=a=>l(e).roleIds=a),multiple:"",placeholder:"\u8BF7\u9009\u62E9\u89D2\u8272"},{default:u(()=>[(i(!0),J(M,null,O(l(v),a=>(i(),f(F,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[R,l(n)]])]),_:1},8,["modelValue"])}}});export{W as _};
