import{av as Z,as as I,aL as j,a4 as b,ch as w,aI as $,D as J,bI as D,d as R,K as F,aJ as ee,bD as te,bJ as le,ci as _,bG as ae,bb as se,cj as oe,au as de,r as P,A as q,f as ne,aY as z}from"./index-QQaZ7rbf.js";const re=R({extends:F,setup(t,d){const r=F.setup(t,d);delete r.selectOptionClick;const p=ee().proxy;return j(()=>{r.select.states.cachedOptions.get(p.value)||r.select.onOptionCreate(p)}),r},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function B(t){return t||t===0}function G(t){return Array.isArray(t)&&t.length}function x(t){return Array.isArray(t)?t:B(t)?[t]:[]}function L(t,d,r,p,n){for(let c=0;c<t.length;c++){const f=t[c];if(d(f,c,t,n))return p?p(f,c,t,n):f;{const O=r(f);if(G(O)){const A=L(O,d,r,p,f);if(A)return A}}}}function T(t,d,r,p){for(let n=0;n<t.length;n++){const c=t[n];d(c,n,t,p);const f=r(c);G(f)&&T(f,d,r,c)}}var ce=R({props:{data:{type:Array,default:()=>[]}},setup(t){const d=se(oe);return I(()=>t.data,()=>{var r;t.data.forEach(n=>{d.states.cachedOptions.has(n.value)||d.states.cachedOptions.set(n.value,n)});const p=((r=d.selectRef)==null?void 0:r.querySelectorAll("input"))||[];Array.from(p).includes(document.activeElement)||d.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const ue=R({name:"ElTreeSelect",inheritAttrs:!1,props:{...J.props,..._.props,cacheData:{type:Array,default:()=>[]}},setup(t,d){const{slots:r,expose:p}=d,n=P(),c=P(),f=b(()=>t.nodeKey||t.valueKey||"value"),O=((e,{attrs:C,emit:E},{select:K,tree:m,key:v})=>{const V=Z("tree-select");return I(()=>e.data,()=>{e.filterable&&j(()=>{var u,a;(a=m.value)==null||a.filter((u=K.value)==null?void 0:u.states.inputValue)})},{flush:"post"}),{...w($(e),Object.keys(J.props)),...C,"onUpdate:modelValue":u=>E(D,u),valueKey:v,popperClass:b(()=>{const u=[V.e("popper")];return e.popperClass&&u.push(e.popperClass),u.join(" ")}),filterMethod:(u="")=>{var a;e.filterMethod?e.filterMethod(u):e.remoteMethod?e.remoteMethod(u):(a=m.value)==null||a.filter(u)}}})(t,d,{select:n,tree:c,key:f}),{cacheOptions:A,...Q}=((e,{attrs:C,slots:E,emit:K},{select:m,tree:v,key:V})=>{I(()=>e.modelValue,()=>{e.showCheckbox&&j(()=>{const l=v.value;l&&!te(l.getCheckedKeys(),x(e.modelValue))&&l.setCheckedKeys(x(e.modelValue))})},{immediate:!0,deep:!0});const u=b(()=>({value:V.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),a=(l,s)=>{var o;const i=u.value[l];return ae(i)?i(s,(o=v.value)==null?void 0:o.getNode(a("value",s))):s[i]},Y=x(e.modelValue).map(l=>L(e.data||[],s=>a("value",s)===l,s=>a("children",s),(s,o,i,k)=>k&&a("value",k))).filter(l=>B(l)),W=b(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const l=[];return T(e.data.concat(e.cacheData),s=>{const o=a("value",s);l.push({value:o,currentLabel:a("label",s),isDisabled:a("disabled",s)})},s=>a("children",s)),l});return{...w($(e),Object.keys(_.props)),...C,nodeKey:V,expandOnClickNode:b(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:b(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(Y):Y),renderContent:(l,{node:s,data:o,store:i})=>l(re,{value:a("value",o),label:a("label",o),disabled:a("disabled",o)},e.renderContent?()=>e.renderContent(l,{node:s,data:o,store:i}):E.default?()=>E.default({node:s,data:o,store:i}):void 0),filterNodeMethod:(l,s,o)=>e.filterNodeMethod?e.filterNodeMethod(l,s,o):!l||new RegExp(le(l),"i").test(a("label",s)||""),onNodeClick:(l,s,o)=>{var i,k,g,N;if((i=C.onNodeClick)==null||i.call(C,l,s,o),!e.showCheckbox||!e.checkOnClickNode){if(e.showCheckbox||!e.checkStrictly&&!s.isLeaf)e.expandOnClickNode&&o.proxy.handleExpandIconClick();else if(!a("disabled",l)){const M=(k=m.value)==null?void 0:k.states.options.get(a("value",l));(g=m.value)==null||g.handleOptionSelect(M)}(N=m.value)==null||N.focus()}},onCheck:(l,s)=>{var o;if(!e.showCheckbox)return;const i=a("value",l),k={};T([v.value.store.root],h=>k[h.key]=h,h=>h.childNodes);const g=s.checkedKeys,N=e.multiple?x(e.modelValue).filter(h=>!(h in k)&&!g.includes(h)):[],M=N.concat(g);if(e.checkStrictly)K(D,e.multiple?M:M.includes(i)?i:void 0);else if(e.multiple)K(D,N.concat(v.value.getCheckedKeys(!0)));else{const h=L([l],y=>!G(a("children",y))&&!a("disabled",y),y=>a("children",y)),S=h?a("value",h):void 0,X=B(e.modelValue)&&!!L([l],y=>a("value",y)===e.modelValue,y=>a("children",y));K(D,S===e.modelValue||X?void 0:S)}j(()=>{var h;const S=x(e.modelValue);v.value.setCheckedKeys(S),(h=C.onCheck)==null||h.call(C,l,{checkedKeys:v.value.getCheckedKeys(),checkedNodes:v.value.getCheckedNodes(),halfCheckedKeys:v.value.getHalfCheckedKeys(),halfCheckedNodes:v.value.getHalfCheckedNodes()})}),(o=m.value)==null||o.focus()},cacheOptions:W}})(t,d,{select:n,tree:c,key:f}),U=q({});return p(U),ne(()=>{Object.assign(U,{...w(c.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...w(n.value,["focus","blur"])})}),()=>z(J,q({...O,ref:e=>n.value=e}),{...r,default:()=>[z(ce,{data:A.value}),z(_,q({...Q,ref:e=>c.value=e}))]})}});var H=de(ue,[["__file","tree-select.vue"]]);H.install=t=>{t.component(H.name,H)};const ie=H;export{ie as E};
