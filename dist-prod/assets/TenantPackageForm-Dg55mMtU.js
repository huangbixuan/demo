import{d as R,e as z,z as G,r as d,A as J,J as h,o as k,w as t,O as W,B as X,a,h as u,C as j,S as D,da as Q,l as f,c2 as Y,x as y,aW as Z,c as $,F as ee,G as ae,U as le,I as se,aX as te,t as ue,P as oe,M as de,_ as re}from"./index-QQaZ7rbf.js";import{_ as ne}from"./Dialog.vue_vue_type_style_index_0_lang-BZRnyNPI.js";import{C as U}from"./constants-D0aoFN3l.js";import{d as me,h as ie}from"./tree-Bh1o0y0-.js";import{a as ce,c as pe,u as ve}from"./index-DXLnACkV.js";import{g as fe}from"./index-D4W76Tl3.js";import{E as _e}from"./index-D_95hI5s.js";const ke=re(R({name:"SystemTenantPackageForm",__name:"TenantPackageForm",emits:["success"],setup(Ve,{expose:S,emit:E}){const{t:V}=z(),b=G(),m=d(!1),x=d(""),i=d(!1),C=d(""),o=d({id:null,name:null,remark:null,menuIds:[],status:U.ENABLE}),A=J({name:[{required:!0,message:"\u5957\u9910\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],status:[{required:!0,message:"\u72B6\u6001\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],menuIds:[{required:!0,message:"\u5173\u8054\u7684\u83DC\u5355\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),_=d(),g=d([]),c=d(!1),n=d(),v=d(!1);S({open:async(s,e)=>{if(m.value=!0,x.value=V("action."+s),C.value=s,N(),g.value=ie(await fe()),e){i.value=!0;try{const r=await ce(e);o.value=r,r.menuIds.forEach(p=>{n.value.setChecked(p,!0,!1)})}finally{i.value=!1}}}});const F=E,M=async()=>{if(_&&await _.value.validate()){i.value=!0;try{const s=o.value;s.menuIds=[...n.value.getCheckedKeys(!1),...n.value.getHalfCheckedKeys()],C.value==="create"?(await pe(s),b.success(V("common.createSuccess"))):(await ve(s),b.success(V("common.updateSuccess"))),m.value=!1,F("success")}finally{i.value=!1}}},N=()=>{var s,e;v.value=!1,c.value=!1,o.value={id:null,name:null,remark:null,menuIds:[],status:U.ENABLE},(s=n.value)==null||s.setCheckedNodes([]),(e=_.value)==null||e.resetFields()},T=()=>{n.value.setCheckedNodes(v.value?g.value:[])},q=()=>{var e;const s=(e=n.value)==null?void 0:e.store.nodesMap;for(let r in s)s[r].expanded!==c.value&&(s[r].expanded=c.value)};return(s,e)=>{const r=D,p=j,w=Y,B=_e,O=te,P=Z,H=X,I=de,K=ne,L=oe;return k(),h(K,{modelValue:a(m),"onUpdate:modelValue":e[6]||(e[6]=l=>y(m)?m.value=l:null),title:a(x)},{footer:t(()=>[u(I,{disabled:a(i),type:"primary",onClick:M},{default:t(()=>[f("\u786E \u5B9A")]),_:1},8,["disabled"]),u(I,{onClick:e[5]||(e[5]=l=>m.value=!1)},{default:t(()=>[f("\u53D6 \u6D88")]),_:1})]),default:t(()=>[W((k(),h(H,{ref_key:"formRef",ref:_,model:a(o),rules:a(A),"label-width":"80px"},{default:t(()=>[u(p,{label:"\u5957\u9910\u540D",prop:"name"},{default:t(()=>[u(r,{modelValue:a(o).name,"onUpdate:modelValue":e[0]||(e[0]=l=>a(o).name=l),placeholder:"\u8BF7\u8F93\u5165\u5957\u9910\u540D"},null,8,["modelValue"])]),_:1}),u(p,{label:"\u83DC\u5355\u6743\u9650"},{default:t(()=>[u(B,{class:"cardHeight"},{header:t(()=>[f(" \u5168\u9009/\u5168\u4E0D\u9009: "),u(w,{modelValue:a(v),"onUpdate:modelValue":e[1]||(e[1]=l=>y(v)?v.value=l:null),"active-text":"\u662F","inactive-text":"\u5426","inline-prompt":"",onChange:T},null,8,["modelValue"]),f(" \u5168\u90E8\u5C55\u5F00/\u6298\u53E0: "),u(w,{modelValue:a(c),"onUpdate:modelValue":e[2]||(e[2]=l=>y(c)?c.value=l:null),"active-text":"\u5C55\u5F00","inactive-text":"\u6298\u53E0","inline-prompt":"",onChange:q},null,8,["modelValue"])]),default:t(()=>[u(a(Q),{ref_key:"treeRef",ref:n,data:a(g),props:a(me),"empty-text":"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u5019","node-key":"id","show-checkbox":""},null,8,["data","props"])]),_:1})]),_:1}),u(p,{label:"\u72B6\u6001",prop:"status"},{default:t(()=>[u(P,{modelValue:a(o).status,"onUpdate:modelValue":e[3]||(e[3]=l=>a(o).status=l)},{default:t(()=>[(k(!0),$(ee,null,ae(a(le)(a(se).COMMON_STATUS),l=>(k(),h(O,{key:l.value,label:l.value},{default:t(()=>[f(ue(l.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(p,{label:"\u5907\u6CE8",prop:"remark"},{default:t(()=>[u(r,{modelValue:a(o).remark,"onUpdate:modelValue":e[4]||(e[4]=l=>a(o).remark=l),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[L,a(i)]])]),_:1},8,["modelValue","title"])}}}),[["__scopeId","data-v-5f5e2086"]]);export{ke as default};
