import{d as B,z as J,e as L,u as O,r as c,A as j,f as E,R as G,c as Q,o as d,h as e,w as l,B as W,a as t,C as X,S as Z,T as R,L as $,O as u,M as ee,l as n,N as ae,J as f,n as le,p as te,t as oe,P as re,F as ie}from"./index-QQaZ7rbf.js";import{_ as ne}from"./index.vue_vue_type_script_setup_true_lang-CtP16Cnh.js";import{_ as me}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CerucUbi.js";import{d as Y}from"./formatTime-esrXlwGe.js";import{d as de}from"./download--D_IyRio.js";import{d as se,e as pe,s as ce,f as ue}from"./index-D-DH1qWO.js";import{g as fe}from"./index-B6q6muef.js";import{_ as we}from"./ImportTable.vue_vue_type_script_setup_true_lang-B2vs_yLR.js";import{_ as ge}from"./PreviewCode.vue_vue_type_style_index_0_lang-1Q3ywngT.js";import"./index-BctfKmg_.js";import"./index-D_95hI5s.js";import"./Dialog.vue_vue_type_style_index_0_lang-BZRnyNPI.js";import"./tree-Bh1o0y0-.js";import"./java-DvOiaz3M.js";const ye=B({name:"InfraCodegen",__name:"index",setup(_e){const y=J(),{t:N}=L(),{push:F}=O(),C=c(!0),x=c(0),V=c([]),r=j({pageNo:1,pageSize:10,tableName:void 0,tableComment:void 0,createTime:[]}),z=c(),S=c([]),g=async()=>{C.value=!0;try{const k=await se(r);V.value=k.list,x.value=k.total}finally{C.value=!1}},_=()=>{r.pageNo=1,g()},K=()=>{z.value.resetFields(),_()},T=c(),D=c();return E(async()=>{await g(),S.value=await fe()}),(k,i)=>{const U=Z,b=X,M=$,h=ae,m=ee,H=W,P=me,s=te,I=le,q=ne,w=G("hasPermi"),A=re;return d(),Q(ie,null,[e(P,null,{default:l(()=>[e(H,{ref_key:"queryFormRef",ref:z,inline:!0,model:t(r),class:"-mb-15px","label-width":"68px"},{default:l(()=>[e(b,{label:"\u8868\u540D\u79F0",prop:"tableName"},{default:l(()=>[e(U,{modelValue:t(r).tableName,"onUpdate:modelValue":i[0]||(i[0]=a=>t(r).tableName=a),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8868\u540D\u79F0",onKeyup:R(_,["enter"])},null,8,["modelValue"])]),_:1}),e(b,{label:"\u8868\u63CF\u8FF0",prop:"tableComment"},{default:l(()=>[e(U,{modelValue:t(r).tableComment,"onUpdate:modelValue":i[1]||(i[1]=a=>t(r).tableComment=a),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8868\u63CF\u8FF0",onKeyup:R(_,["enter"])},null,8,["modelValue"])]),_:1}),e(b,{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},{default:l(()=>[e(M,{modelValue:t(r).createTime,"onUpdate:modelValue":i[2]||(i[2]=a=>t(r).createTime=a),"default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-240px","end-placeholder":"\u7ED3\u675F\u65E5\u671F","start-placeholder":"\u5F00\u59CB\u65E5\u671F",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),e(b,null,{default:l(()=>[e(m,{onClick:_},{default:l(()=>[e(h,{class:"mr-5px",icon:"ep:search"}),n(" \u641C\u7D22 ")]),_:1}),e(m,{onClick:K},{default:l(()=>[e(h,{class:"mr-5px",icon:"ep:refresh"}),n(" \u91CD\u7F6E ")]),_:1}),u((d(),f(m,{type:"primary",onClick:i[3]||(i[3]=a=>{T.value.open()})},{default:l(()=>[e(h,{class:"mr-5px",icon:"ep:zoom-in"}),n(" \u5BFC\u5165 ")]),_:1})),[[w,["infra:codegen:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(P,null,{default:l(()=>[u((d(),f(I,{data:t(V)},{default:l(()=>[e(s,{align:"center",label:"\u6570\u636E\u6E90"},{default:l(a=>{var p;return[n(oe((p=t(S).find(o=>o.id===a.row.dataSourceConfigId))==null?void 0:p.name),1)]}),_:1}),e(s,{align:"center",label:"\u8868\u540D\u79F0",prop:"tableName",width:"200"}),e(s,{"show-overflow-tooltip":!0,align:"center",label:"\u8868\u63CF\u8FF0",prop:"tableComment",width:"200"}),e(s,{align:"center",label:"\u5B9E\u4F53",prop:"className",width:"200"}),e(s,{formatter:t(Y),align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:"180"},null,8,["formatter"]),e(s,{formatter:t(Y),align:"center",label:"\u66F4\u65B0\u65F6\u95F4",prop:"createTime",width:"180"},null,8,["formatter"]),e(s,{align:"center",fixed:"right",label:"\u64CD\u4F5C",width:"300px"},{default:l(a=>[u((d(),f(m,{link:"",type:"primary",onClick:p=>{return o=a.row,void D.value.open(o.id);var o}},{default:l(()=>[n(" \u9884\u89C8 ")]),_:2},1032,["onClick"])),[[w,["infra:codegen:preview"]]]),u((d(),f(m,{link:"",type:"primary",onClick:p=>{return o=a.row.id,void F("/codegen/edit?id="+o);var o}},{default:l(()=>[n(" \u7F16\u8F91 ")]),_:2},1032,["onClick"])),[[w,["infra:codegen:update"]]]),u((d(),f(m,{link:"",type:"danger",onClick:p=>(async o=>{try{await y.delConfirm(),await pe(o),y.success(N("common.delSuccess")),await g()}catch{}})(a.row.id)},{default:l(()=>[n(" \u5220\u9664 ")]),_:2},1032,["onClick"])),[[w,["infra:codegen:delete"]]]),u((d(),f(m,{link:"",type:"primary",onClick:p=>(async o=>{const v=o.tableName;try{await y.confirm("\u786E\u8BA4\u8981\u5F3A\u5236\u540C\u6B65"+v+"\u8868\u7ED3\u6784\u5417?",N("common.reminder")),await ce(o.id),y.success("\u540C\u6B65\u6210\u529F")}catch{}})(a.row)},{default:l(()=>[n(" \u540C\u6B65 ")]),_:2},1032,["onClick"])),[[w,["infra:codegen:update"]]]),u((d(),f(m,{link:"",type:"primary",onClick:p=>(async o=>{const v=await ue(o.id);de.zip(v,"codegen-"+o.className+".zip")})(a.row)},{default:l(()=>[n(" \u751F\u6210\u4EE3\u7801 ")]),_:2},1032,["onClick"])),[[w,["infra:codegen:download"]]])]),_:1})]),_:1},8,["data"])),[[A,t(C)]]),e(q,{limit:t(r).pageSize,"onUpdate:limit":i[4]||(i[4]=a=>t(r).pageSize=a),page:t(r).pageNo,"onUpdate:page":i[5]||(i[5]=a=>t(r).pageNo=a),total:t(x),onPagination:g},null,8,["limit","page","total"])]),_:1}),e(we,{ref_key:"importRef",ref:T,onSuccess:g},null,512),e(ge,{ref_key:"previewRef",ref:D},null,512)],64)}}});export{ye as default};
