import{d as H,z as Q,r as u,A as W,f as X,J as g,o as p,w as a,h as e,B as Y,aV as Z,a as t,C as $,S as ee,T as ae,M as le,l as i,N as te,O as oe,n as se,p as ne,c as N,F as ie,G as re,k as ue,t as de,P as pe,g as U,x as ce,cm as me}from"./index-QQaZ7rbf.js";import{_ as fe}from"./index.vue_vue_type_script_setup_true_lang-CtP16Cnh.js";import{_ as ge}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CerucUbi.js";import{d as _e}from"./formatTime-esrXlwGe.js";import{a as be,b as ve}from"./index-DJTZl51b.js";import{b as ye}from"./index-BMmUWe6o.js";import{_ as ke}from"./main.vue_vue_type_script_setup_true_lang-CdYlBeNF.js";const we={class:"footBtnBox"},he={class:"dialog-footer"},Se=H({__name:"SelectUser",emits:["saveUser"],setup(xe,{expose:V,emit:z}){const F=Q(),d=u(!1),_=u(!0),k=u(0),w=u([]),o=W({pageNo:1,pageSize:10,accountId:0,isAdminNotice:0,nickname:null}),h=u(null),S=u([]),c=u([]),A=s=>{o.pageNo=1,o.accountId=s,m()},m=async()=>{try{_.value=!0;const s=await be(o);w.value=s.list,k.value=s.total}finally{_.value=!1}},b=()=>{o.pageNo=1,m()},B=()=>{var l;const s=o.accountId;(l=h.value)==null||l.resetFields(),o.accountId=s,b()},T=s=>{c.value=s},q=()=>{d.value=!1};V({open:async()=>{d.value=!0,m()}});const J=z,P=async()=>{if(!c.value||c.value.length<=0)return void F.error("\u8BF7\u9009\u62E9\u6570\u636E");let s=c.value.map(l=>l.id);await ve({ids:s.toString()}),J("saveUser"),d.value=!1};return X(async()=>{S.value=await ye()}),(s,l)=>{const v=$,G=ee,x=te,f=le,K=Y,I=ge,r=ne,y=ue,L=se,M=fe,O=me,R=pe;return p(),g(O,{modelValue:t(d),"onUpdate:modelValue":l[4]||(l[4]=n=>ce(d)?d.value=n:null),title:"\u9009\u62E9\u5FAE\u4FE1\u516C\u4F17\u53F7\u7528\u6237",width:"70%",top:"50px",class:"group-dialog","close-on-click-modal":!1,"modal-append-to-body":!1,modal:!1},{footer:a(()=>[U("div",we,[U("span",he,[e(f,{type:"primary",onClick:P},{default:a(()=>[i("\u786E \u5B9A")]),_:1}),e(f,{onClick:q},{default:a(()=>[i("\u53D6 \u6D88")]),_:1})])])]),default:a(()=>[e(I,null,{default:a(()=>[e(K,{class:"-mb-15px",model:t(o),ref_key:"queryFormRef",ref:h,inline:!0,"label-width":"68px",onSubmit:l[1]||(l[1]=Z(()=>{},["prevent"]))},{default:a(()=>[e(v,{label:"\u516C\u4F17\u53F7",prop:"accountId"},{default:a(()=>[e(t(ke),{onChange:A})]),_:1}),e(v,{label:"\u6635\u79F0",prop:"nickname"},{default:a(()=>[e(G,{modelValue:t(o).nickname,"onUpdate:modelValue":l[0]||(l[0]=n=>t(o).nickname=n),placeholder:"\u8BF7\u8F93\u5165\u6635\u79F0",clearable:"",onKeyup:ae(b,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(v,null,{default:a(()=>[e(f,{onClick:b},{default:a(()=>[e(x,{icon:"ep:search"}),i("\u641C\u7D22 ")]),_:1}),e(f,{onClick:B},{default:a(()=>[e(x,{icon:"ep:refresh"}),i("\u91CD\u7F6E ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(I,null,{default:a(()=>[oe((p(),g(L,{data:t(w),"row-key":"id",onSelectionChange:T},{default:a(()=>[e(r,{type:"selection","reserve-selection":!0,width:"55"}),e(r,{label:"\u7528\u6237\u6807\u8BC6",align:"center",prop:"openid",width:"260"}),e(r,{label:"\u6635\u79F0",align:"center",prop:"nickname"}),e(r,{label:"\u5907\u6CE8",align:"center",prop:"remark"}),e(r,{label:"\u6807\u7B7E",align:"center",prop:"tagIds",width:"200"},{default:a(n=>[(p(!0),N(ie,null,re(n.row.tagIds,(j,D)=>(p(),N("span",{key:D},[e(y,null,{default:a(()=>{var C;return[i(de((C=t(S).find(E=>E.tagId===j))==null?void 0:C.name),1)]}),_:2},1024),i("\xA0 ")]))),128))]),_:1}),e(r,{label:"\u8BA2\u9605\u72B6\u6001",align:"center",prop:"subscribeStatus"},{default:a(n=>[n.row.subscribeStatus===0?(p(),g(y,{key:0,type:"success"},{default:a(()=>[i("\u5DF2\u8BA2\u9605")]),_:1})):(p(),g(y,{key:1,type:"danger"},{default:a(()=>[i("\u672A\u8BA2\u9605")]),_:1}))]),_:1}),e(r,{label:"\u8BA2\u9605\u65F6\u95F4",align:"center",prop:"subscribeTime",width:"180",formatter:t(_e)},null,8,["formatter"])]),_:1},8,["data"])),[[R,t(_)]]),e(M,{total:t(k),page:t(o).pageNo,"onUpdate:page":l[2]||(l[2]=n=>t(o).pageNo=n),limit:t(o).pageSize,"onUpdate:limit":l[3]||(l[3]=n=>t(o).pageSize=n),onPagination:m},null,8,["total","page","limit"])]),_:1})]),_:1},8,["modelValue"])}}});export{Se as _};
