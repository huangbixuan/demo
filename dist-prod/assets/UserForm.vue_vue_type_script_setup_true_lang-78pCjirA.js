import{d as M,e as O,z as P,r as m,A as T,J as f,o as p,w as a,O as X,B as Y,a as l,h as e,m as $,E as j,C as H,S as Q,i as x,D as W,c as E,F as S,G as C,U as Z,I as ee,K as le,P as ae,M as de,l as F,x as se}from"./index-QQaZ7rbf.js";import{_ as ue}from"./Dialog.vue_vue_type_style_index_0_lang-BZRnyNPI.js";import{E as oe}from"./el-tree-select-BtYVvkSk.js";import{C as q}from"./constants-D0aoFN3l.js";import{d as te,h as re}from"./tree-Bh1o0y0-.js";import{b as me}from"./index-BfdFuESF.js";import{a as pe}from"./index-BmQEDQ_i.js";import{a as ne,c as ie,u as ce}from"./index-uPKJ4_LV.js";const fe=M({name:"SystemUserForm",__name:"UserForm",emits:["success"],setup(_e,{expose:A,emit:B}){const{t:b}=O(),V=P(),n=m(!1),g=m(""),i=m(!1),k=m(""),u=m({nickname:"",deptId:"",mobile:"",email:"",id:void 0,username:"",password:"",sex:void 0,postIds:[],remark:"",status:q.ENABLE,roleIds:[]}),L=T({username:[{required:!0,message:"\u7528\u6237\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],nickname:[{required:!0,message:"\u7528\u6237\u6635\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],deptId:[{required:!0,message:"\u8BF7\u9009\u62E9\u90E8\u95E8",trigger:"blur"}],password:[{required:!0,message:"\u7528\u6237\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],email:[{type:"email",message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1\u5730\u5740",trigger:["blur","change"]}],mobile:[{pattern:/^(?:(?:\+|00)86)?1(?:3[\d]|4[5-79]|5[0-35-9]|6[5-7]|7[0-8]|8[\d]|9[189])\d{8}$/,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u7801",trigger:"blur"}]}),v=m(),y=m([]),h=m([]);A({open:async(o,s)=>{if(n.value=!0,g.value=b("action."+o),k.value=o,K(),s){i.value=!0;try{u.value=await ne(s)}finally{i.value=!1}}y.value=re(await pe()),h.value=await me()}});const D=B,G=async()=>{if(v&&await v.value.validate()){i.value=!0;try{const o=u.value;k.value==="create"?(await ie(o),V.success(b("common.createSuccess"))):(await ce(o),V.success(b("common.updateSuccess"))),n.value=!1,D("success")}finally{i.value=!1}}},K=()=>{var o;u.value={nickname:"",deptId:"",mobile:"",email:"",id:void 0,username:"",password:"",sex:void 0,postIds:[],remark:"",status:q.ENABLE,roleIds:[]},(o=v.value)==null||o.resetFields()};return(o,s)=>{const c=Q,t=H,r=j,N=oe,_=$,w=le,U=W,R=Y,I=de,z=ue,J=ae;return p(),f(z,{modelValue:l(n),"onUpdate:modelValue":s[10]||(s[10]=d=>se(n)?n.value=d:null),title:l(g)},{footer:a(()=>[e(I,{disabled:l(i),type:"primary",onClick:G},{default:a(()=>[F("\u786E \u5B9A")]),_:1},8,["disabled"]),e(I,{onClick:s[9]||(s[9]=d=>n.value=!1)},{default:a(()=>[F("\u53D6 \u6D88")]),_:1})]),default:a(()=>[X((p(),f(R,{ref_key:"formRef",ref:v,model:l(u),rules:l(L),"label-width":"80px"},{default:a(()=>[e(_,null,{default:a(()=>[e(r,{span:12},{default:a(()=>[e(t,{label:"\u7528\u6237\u6635\u79F0",prop:"nickname"},{default:a(()=>[e(c,{modelValue:l(u).nickname,"onUpdate:modelValue":s[0]||(s[0]=d=>l(u).nickname=d),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u6635\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(t,{label:"\u5F52\u5C5E\u90E8\u95E8",prop:"deptId"},{default:a(()=>[e(N,{modelValue:l(u).deptId,"onUpdate:modelValue":s[1]||(s[1]=d=>l(u).deptId=d),data:l(y),props:l(te),"check-strictly":"","node-key":"id",placeholder:"\u8BF7\u9009\u62E9\u5F52\u5C5E\u90E8\u95E8"},null,8,["modelValue","data","props"])]),_:1})]),_:1})]),_:1}),e(_,null,{default:a(()=>[e(r,{span:12},{default:a(()=>[e(t,{label:"\u624B\u673A\u53F7\u7801",prop:"mobile"},{default:a(()=>[e(c,{modelValue:l(u).mobile,"onUpdate:modelValue":s[2]||(s[2]=d=>l(u).mobile=d),maxlength:"11",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(t,{label:"\u90AE\u7BB1",prop:"email"},{default:a(()=>[e(c,{modelValue:l(u).email,"onUpdate:modelValue":s[3]||(s[3]=d=>l(u).email=d),maxlength:"50",placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,null,{default:a(()=>[e(r,{span:12},{default:a(()=>[l(u).id===void 0?(p(),f(t,{key:0,label:"\u7528\u6237\u540D\u79F0",prop:"username"},{default:a(()=>[e(c,{modelValue:l(u).username,"onUpdate:modelValue":s[4]||(s[4]=d=>l(u).username=d),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u79F0"},null,8,["modelValue"])]),_:1})):x("",!0)]),_:1}),e(r,{span:12},{default:a(()=>[l(u).id===void 0?(p(),f(t,{key:0,label:"\u7528\u6237\u5BC6\u7801",prop:"password"},{default:a(()=>[e(c,{modelValue:l(u).password,"onUpdate:modelValue":s[5]||(s[5]=d=>l(u).password=d),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u5BC6\u7801","show-password":"",type:"password"},null,8,["modelValue"])]),_:1})):x("",!0)]),_:1})]),_:1}),e(_,null,{default:a(()=>[e(r,{span:12},{default:a(()=>[e(t,{label:"\u7528\u6237\u6027\u522B"},{default:a(()=>[e(U,{modelValue:l(u).sex,"onUpdate:modelValue":s[6]||(s[6]=d=>l(u).sex=d),placeholder:"\u8BF7\u9009\u62E9"},{default:a(()=>[(p(!0),E(S,null,C(l(Z)(l(ee).SYSTEM_USER_SEX),d=>(p(),f(w,{key:d.value,label:d.label,value:d.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(t,{label:"\u5C97\u4F4D"},{default:a(()=>[e(U,{modelValue:l(u).postIds,"onUpdate:modelValue":s[7]||(s[7]=d=>l(u).postIds=d),multiple:"",placeholder:"\u8BF7\u9009\u62E9"},{default:a(()=>[(p(!0),E(S,null,C(l(h),d=>(p(),f(w,{key:d.id,label:d.name,value:d.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,null,{default:a(()=>[e(r,{span:24},{default:a(()=>[e(t,{label:"\u5907\u6CE8"},{default:a(()=>[e(c,{modelValue:l(u).remark,"onUpdate:modelValue":s[8]||(s[8]=d=>l(u).remark=d),placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[J,l(i)]])]),_:1},8,["modelValue","title"])}}});export{fe as _};
